Upstream test at:
https://github.com/canonical/cloud-init/blob/master/tests/integration_tests/test_upgrade.py

Logs from individual before/after runs in openstack-sru-21.1-19 subdirectory

==== Xenial ====
============================= test session starts ==============================
platform linux -- Python 3.5.9, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /home/james/cloud-init-tests, inifile: tox.ini
plugins: cov-2.9.0
collected 1 item

tests/integration_tests/test_upgrade.py::test_upgrade Detected image: image_id=dc01c30f-5805-475d-aca7-8b05ffed488f os=ubuntu release=xenial

-------------------------------- live log setup --------------------------------
2021-03-29 16:11:01 INFO      integration_testing:clouds.py:87 Detected image: image_id=dc01c30f-5805-475d-aca7-8b05ffed488f os=ubuntu release=xenial
Detected image: image_id=dc01c30f-5805-475d-aca7-8b05ffed488f os=ubuntu release=xenial
2021-03-29 16:11:01 INFO      integration_testing:clouds.py:87 Detected image: image_id=dc01c30f-5805-475d-aca7-8b05ffed488f os=ubuntu release=xenial
Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=dc01c30f-5805-475d-aca7-8b05ffed488f::ubuntu::xenial
PLATFORM=openstack
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
2021-03-29 16:11:01 INFO      integration_testing:clouds.py:128 Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=dc01c30f-5805-475d-aca7-8b05ffed488f::ubuntu::xenial
PLATFORM=openstack
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
Detected image: image_id=dc01c30f-5805-475d-aca7-8b05ffed488f os=ubuntu release=xenial
-------------------------------- live log call ---------------------------------
2021-03-29 16:11:01 INFO      integration_testing:clouds.py:87 Detected image: image_id=dc01c30f-5805-475d-aca7-8b05ffed488f os=ubuntu release=xenial
Detected image: image_id=dc01c30f-5805-475d-aca7-8b05ffed488f os=ubuntu release=xenial
2021-03-29 16:11:01 INFO      integration_testing:clouds.py:87 Detected image: image_id=dc01c30f-5805-475d-aca7-8b05ffed488f os=ubuntu release=xenial
Launching instance with launch_kwargs:
image_id=dc01c30f-5805-475d-aca7-8b05ffed488f
user_data=#cloud-config
hostname: SRU-worked

2021-03-29 16:11:01 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
image_id=dc01c30f-5805-475d-aca7-8b05ffed488f
user_data=#cloud-config
hostname: SRU-worked

2021-03-29 16:11:39 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-03-29 16:11:42 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (596s left)
2021-03-29 16:11:46 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (592s left)
2021-03-29 16:11:47 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (591s left)
2021-03-29 16:11:48 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (590s left)
2021-03-29 16:11:49 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (589s left)
2021-03-29 16:11:50 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (588s left)
2021-03-29 16:11:51 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (587s left)
2021-03-29 16:11:52 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (586s left)
2021-03-29 16:11:54 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (585s left)
2021-03-29 16:11:55 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (584s left)
2021-03-29 16:11:56 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (583s left)
2021-03-29 16:11:57 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (582s left)
2021-03-29 16:11:58 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (581s left)
2021-03-29 16:12:00 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (579s left)
2021-03-29 16:12:01 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (578s left)
2021-03-29 16:12:02 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.2p2)
2021-03-29 16:12:02 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-29 16:12:03 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cloud-init status --help'
2021-03-29 16:12:05 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: OpenstackInstance(instance_id=15c2d3e4-52e1-4d0d-b89e-581b91eaa471)
2021-03-29 16:12:08 INFO      integration_testing:clouds.py:171 Launched instance: OpenstackInstance(instance_id=15c2d3e4-52e1-4d0d-b89e-581b91eaa471)
2021-03-29 16:12:08 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 20.3-2-g371b392c-0ubuntu1~16.04.1
2021-03-29 16:12:09 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 20.3-2-g371b392c-0ubuntu1~16.04.1
2021-03-29 16:12:09 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20201014
2021-03-29 16:12:09 INFO      integration_testing:clouds.py:181 image serial: 20201014
2021-03-29 16:12:09 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
2021-03-29 16:12:09 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'dpkg-query --show cloud-init'
2021-03-29 16:12:09 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /run/cloud-init/result.json'
2021-03-29 16:12:10 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init init'
2021-03-29 16:12:11 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep Trace /var/log/cloud-init.log'
2021-03-29 16:12:11 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c cloud-id
2021-03-29 16:12:11 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /etc/network/interfaces.d/50-cloud-init.cfg'
2021-03-29 16:12:11 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c systemd-analyze
2021-03-29 16:12:12 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'systemd-analyze blame'
2021-03-29 16:12:12 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze show'
2021-03-29 16:12:12 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze blame'
Installing proposed image
2021-03-29 16:12:13 INFO      integration_testing:instances.py:144 Installing proposed image
2021-03-29 16:12:13 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'echo deb "http://archive.ubuntu.com/ubuntu $(lsb_release -sc)-proposed main" | tee /etc/apt/sources.list.d/proposed.list
apt-get update -q
apt-get install -qy cloud-init'
2021-03-29 16:12:28 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init -v'
Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~16.04.1
2021-03-29 16:12:29 INFO      integration_testing:instances.py:136 Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~16.04.1
2021-03-29 16:12:29 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-29 16:12:29 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-03-29 16:12:30 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'hostname something-else'
Restarting instance and waiting for boot
2021-03-29 16:12:30 INFO      integration_testing:instances.py:65 Restarting instance and waiting for boot
2021-03-29 16:12:41 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-03-29 16:12:56 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (584s left)
2021-03-29 16:12:57 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (583s left)
2021-03-29 16:12:58 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (582s left)
2021-03-29 16:12:59 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (581s left)
2021-03-29 16:13:00 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (580s left)
2021-03-29 16:13:02 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (579s left)
2021-03-29 16:13:03 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (578s left)
2021-03-29 16:13:04 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (577s left)
2021-03-29 16:13:05 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (576s left)
2021-03-29 16:13:06 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (575s left)
2021-03-29 16:13:07 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (574s left)
2021-03-29 16:13:08 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.173
Retrying SSH connection to ubuntu@10.245.164.173:22 (573s left)
2021-03-29 16:13:09 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.2p2)
2021-03-29 16:13:09 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-29 16:13:10 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cloud-init status --help'
2021-03-29 16:13:11 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
2021-03-29 16:13:11 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init status --wait --long'
2021-03-29 16:13:12 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
2021-03-29 16:13:12 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'dpkg-query --show cloud-init'
2021-03-29 16:13:12 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /run/cloud-init/result.json'
2021-03-29 16:13:12 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init init'
2021-03-29 16:13:13 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep Trace /var/log/cloud-init.log'
2021-03-29 16:13:13 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c cloud-id
2021-03-29 16:13:13 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /etc/network/interfaces.d/50-cloud-init.cfg'
2021-03-29 16:13:14 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c systemd-analyze
2021-03-29 16:13:14 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'systemd-analyze blame'
2021-03-29 16:13:14 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze show'
2021-03-29 16:13:15 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze blame'
Wrote upgrade test logs to /tmp/cloud_init_test_logs/test_upgrade_openstack_xenial_before_210329111101.log and /tmp/cloud_init_test_logs/test_upgrade_openstack_xenial_after_210329111101.log
2021-03-29 16:13:20 INFO      integration_testing:test_upgrade.py:98 Wrote upgrade test logs to /tmp/cloud_init_test_logs/test_upgrade_openstack_xenial_before_210329111101.log and /tmp/cloud_init_test_logs/test_upgrade_openstack_xenial_after_210329111101.log
PASSED

=============================== warnings summary ===============================
tests/integration_tests/test_upgrade.py: 44 tests with warnings
  /home/james/envs/cloud-init/lib/python3.5/site-packages/openstack/resource.py:351: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() instead
    len(inspect.getargspec(type_).args) > 1)

-- Docs: https://docs.pytest.org/en/latest/warnings.html
================== 1 passed, 44 warnings in 139.01s (0:02:19) ==================


==== Bionic ====
============================= test session starts ==============================
platform linux -- Python 3.5.9, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /home/james/cloud-init-tests, inifile: tox.ini
plugins: cov-2.9.0
collected 1 item

tests/integration_tests/test_upgrade.py::test_upgrade Detected image: image_id=6a03fb86-4462-4862-96eb-a51640eaecba os=ubuntu release=bionic

-------------------------------- live log setup --------------------------------
2021-03-29 16:18:59 INFO      integration_testing:clouds.py:87 Detected image: image_id=6a03fb86-4462-4862-96eb-a51640eaecba os=ubuntu release=bionic
Detected image: image_id=6a03fb86-4462-4862-96eb-a51640eaecba os=ubuntu release=bionic
2021-03-29 16:18:59 INFO      integration_testing:clouds.py:87 Detected image: image_id=6a03fb86-4462-4862-96eb-a51640eaecba os=ubuntu release=bionic
Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=6a03fb86-4462-4862-96eb-a51640eaecba::ubuntu::bionic
PLATFORM=openstack
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
2021-03-29 16:18:59 INFO      integration_testing:clouds.py:128 Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=6a03fb86-4462-4862-96eb-a51640eaecba::ubuntu::bionic
PLATFORM=openstack
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
Detected image: image_id=6a03fb86-4462-4862-96eb-a51640eaecba os=ubuntu release=bionic
-------------------------------- live log call ---------------------------------
2021-03-29 16:18:59 INFO      integration_testing:clouds.py:87 Detected image: image_id=6a03fb86-4462-4862-96eb-a51640eaecba os=ubuntu release=bionic
Detected image: image_id=6a03fb86-4462-4862-96eb-a51640eaecba os=ubuntu release=bionic
2021-03-29 16:18:59 INFO      integration_testing:clouds.py:87 Detected image: image_id=6a03fb86-4462-4862-96eb-a51640eaecba os=ubuntu release=bionic
Launching instance with launch_kwargs:
image_id=6a03fb86-4462-4862-96eb-a51640eaecba
user_data=#cloud-config
hostname: SRU-worked

2021-03-29 16:18:59 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
image_id=6a03fb86-4462-4862-96eb-a51640eaecba
user_data=#cloud-config
hostname: SRU-worked

2021-03-29 16:19:16 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-03-29 16:19:20 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (596s left)
2021-03-29 16:19:24 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (592s left)
2021-03-29 16:19:28 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (588s left)
2021-03-29 16:19:32 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (584s left)
2021-03-29 16:19:34 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (581s left)
2021-03-29 16:19:35 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (580s left)
2021-03-29 16:19:36 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (579s left)
2021-03-29 16:19:37 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (578s left)
2021-03-29 16:19:38 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (577s left)
2021-03-29 16:19:39 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (576s left)
2021-03-29 16:19:41 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (575s left)
2021-03-29 16:19:42 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (574s left)
2021-03-29 16:19:43 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (573s left)
2021-03-29 16:19:44 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (572s left)
2021-03-29 16:19:45 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (571s left)
2021-03-29 16:19:46 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (570s left)
2021-03-29 16:19:47 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (569s left)
2021-03-29 16:19:48 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (568s left)
2021-03-29 16:19:49 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (567s left)
2021-03-29 16:19:50 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.6p1)
2021-03-29 16:19:50 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-29 16:19:53 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cloud-init status --help'
2021-03-29 16:19:55 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: OpenstackInstance(instance_id=7b822733-94f7-4ec1-ae92-4e856441e157)
2021-03-29 16:19:56 INFO      integration_testing:clouds.py:171 Launched instance: OpenstackInstance(instance_id=7b822733-94f7-4ec1-ae92-4e856441e157)
2021-03-29 16:19:56 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 20.3-2-g371b392c-0ubuntu1~18.04.1
2021-03-29 16:19:57 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 20.3-2-g371b392c-0ubuntu1~18.04.1
2021-03-29 16:19:57 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20201117
2021-03-29 16:19:57 INFO      integration_testing:clouds.py:181 image serial: 20201117
2021-03-29 16:19:57 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
2021-03-29 16:19:57 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'dpkg-query --show cloud-init'
2021-03-29 16:19:57 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /run/cloud-init/result.json'
2021-03-29 16:19:57 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init init'
2021-03-29 16:19:58 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep Trace /var/log/cloud-init.log'
2021-03-29 16:19:59 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c cloud-id
2021-03-29 16:19:59 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /etc/netplan/50-cloud-init.yaml'
2021-03-29 16:19:59 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c systemd-analyze
2021-03-29 16:20:00 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'systemd-analyze blame'
2021-03-29 16:20:00 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze show'
2021-03-29 16:20:01 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze blame'
Installing proposed image
2021-03-29 16:20:02 INFO      integration_testing:instances.py:144 Installing proposed image
2021-03-29 16:20:02 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'echo deb "http://archive.ubuntu.com/ubuntu $(lsb_release -sc)-proposed main" | tee /etc/apt/sources.list.d/proposed.list
apt-get update -q
apt-get install -qy cloud-init'
2021-03-29 16:20:22 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init -v'
Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~18.04.1
2021-03-29 16:20:23 INFO      integration_testing:instances.py:136 Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~18.04.1
2021-03-29 16:20:23 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-29 16:20:24 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-03-29 16:20:24 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'hostname something-else'
Restarting instance and waiting for boot
2021-03-29 16:20:24 INFO      integration_testing:instances.py:65 Restarting instance and waiting for boot
2021-03-29 16:20:37 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-03-29 16:20:55 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (582s left)
2021-03-29 16:20:56 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (581s left)
2021-03-29 16:20:57 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (580s left)
2021-03-29 16:20:58 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (579s left)
2021-03-29 16:20:59 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (578s left)
2021-03-29 16:21:00 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (577s left)
2021-03-29 16:21:01 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (576s left)
2021-03-29 16:21:02 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (574s left)
2021-03-29 16:21:03 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (573s left)
2021-03-29 16:21:04 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (572s left)
2021-03-29 16:21:05 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (571s left)
2021-03-29 16:21:07 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (569s left)
2021-03-29 16:21:08 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (568s left)
2021-03-29 16:21:09 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (567s left)
2021-03-29 16:21:10 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.179
Retrying SSH connection to ubuntu@10.245.164.179:22 (566s left)
2021-03-29 16:21:11 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.6p1)
2021-03-29 16:21:12 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-29 16:21:14 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cloud-init status --help'
2021-03-29 16:21:16 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
2021-03-29 16:21:17 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init status --wait --long'
2021-03-29 16:21:18 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
2021-03-29 16:21:18 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'dpkg-query --show cloud-init'
2021-03-29 16:21:18 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /run/cloud-init/result.json'
2021-03-29 16:21:18 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init init'
2021-03-29 16:21:19 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep Trace /var/log/cloud-init.log'
2021-03-29 16:21:20 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c cloud-id
2021-03-29 16:21:20 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /etc/netplan/50-cloud-init.yaml'
2021-03-29 16:21:20 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c systemd-analyze
2021-03-29 16:21:21 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'systemd-analyze blame'
2021-03-29 16:21:21 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze show'
2021-03-29 16:21:22 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze blame'
Wrote upgrade test logs to /tmp/cloud_init_test_logs/test_upgrade_openstack_bionic_before_210329111859.log and /tmp/cloud_init_test_logs/test_upgrade_openstack_bionic_after_210329111859.log
2021-03-29 16:21:27 INFO      integration_testing:test_upgrade.py:98 Wrote upgrade test logs to /tmp/cloud_init_test_logs/test_upgrade_openstack_bionic_before_210329111859.log and /tmp/cloud_init_test_logs/test_upgrade_openstack_bionic_after_210329111859.log
PASSED

=============================== warnings summary ===============================
tests/integration_tests/test_upgrade.py: 44 tests with warnings
  /home/james/envs/cloud-init/lib/python3.5/site-packages/openstack/resource.py:351: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() instead
    len(inspect.getargspec(type_).args) > 1)

-- Docs: https://docs.pytest.org/en/latest/warnings.html
================== 1 passed, 44 warnings in 148.19s (0:02:28) ==================


==== Focal ====
============================= test session starts ==============================
platform linux -- Python 3.5.9, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /home/james/cloud-init-tests, inifile: tox.ini
plugins: cov-2.9.0
collected 1 item

tests/integration_tests/test_upgrade.py::test_upgrade Detected image: image_id=7fbeaa81-41bc-4d6d-9fb6-a63a39a11a4f os=ubuntu release=focal

-------------------------------- live log setup --------------------------------
2021-03-29 16:13:22 INFO      integration_testing:clouds.py:87 Detected image: image_id=7fbeaa81-41bc-4d6d-9fb6-a63a39a11a4f os=ubuntu release=focal
Detected image: image_id=7fbeaa81-41bc-4d6d-9fb6-a63a39a11a4f os=ubuntu release=focal
2021-03-29 16:13:22 INFO      integration_testing:clouds.py:87 Detected image: image_id=7fbeaa81-41bc-4d6d-9fb6-a63a39a11a4f os=ubuntu release=focal
Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=7fbeaa81-41bc-4d6d-9fb6-a63a39a11a4f::ubuntu::focal
PLATFORM=openstack
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
2021-03-29 16:13:22 INFO      integration_testing:clouds.py:128 Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=7fbeaa81-41bc-4d6d-9fb6-a63a39a11a4f::ubuntu::focal
PLATFORM=openstack
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
Detected image: image_id=7fbeaa81-41bc-4d6d-9fb6-a63a39a11a4f os=ubuntu release=focal
-------------------------------- live log call ---------------------------------
2021-03-29 16:13:22 INFO      integration_testing:clouds.py:87 Detected image: image_id=7fbeaa81-41bc-4d6d-9fb6-a63a39a11a4f os=ubuntu release=focal
Detected image: image_id=7fbeaa81-41bc-4d6d-9fb6-a63a39a11a4f os=ubuntu release=focal
2021-03-29 16:13:22 INFO      integration_testing:clouds.py:87 Detected image: image_id=7fbeaa81-41bc-4d6d-9fb6-a63a39a11a4f os=ubuntu release=focal
Launching instance with launch_kwargs:
image_id=7fbeaa81-41bc-4d6d-9fb6-a63a39a11a4f
user_data=#cloud-config
hostname: SRU-worked

2021-03-29 16:13:22 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
image_id=7fbeaa81-41bc-4d6d-9fb6-a63a39a11a4f
user_data=#cloud-config
hostname: SRU-worked

2021-03-29 16:13:48 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-03-29 16:13:51 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (596s left)
2021-03-29 16:13:55 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (592s left)
2021-03-29 16:13:59 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (588s left)
2021-03-29 16:14:04 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (584s left)
2021-03-29 16:14:08 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (580s left)
2021-03-29 16:14:12 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (576s left)
2021-03-29 16:14:16 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (572s left)
2021-03-29 16:14:20 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (568s left)
2021-03-29 16:14:24 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (564s left)
2021-03-29 16:14:28 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (560s left)
2021-03-29 16:14:32 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (555s left)
2021-03-29 16:14:35 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (553s left)
2021-03-29 16:14:36 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (552s left)
2021-03-29 16:14:37 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (551s left)
2021-03-29 16:14:38 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (550s left)
2021-03-29 16:14:39 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (549s left)
2021-03-29 16:14:40 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (548s left)
2021-03-29 16:14:41 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (546s left)
2021-03-29 16:14:42 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (545s left)
2021-03-29 16:14:43 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (544s left)
2021-03-29 16:14:44 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (543s left)
2021-03-29 16:14:45 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (542s left)
2021-03-29 16:14:46 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (541s left)
2021-03-29 16:14:55 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (533s left)
2021-03-29 16:14:56 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (532s left)
2021-03-29 16:14:57 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (531s left)
2021-03-29 16:14:58 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (530s left)
2021-03-29 16:14:59 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (529s left)
2021-03-29 16:15:00 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (528s left)
2021-03-29 16:15:01 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (527s left)
2021-03-29 16:15:02 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (526s left)
2021-03-29 16:15:03 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (525s left)
2021-03-29 16:15:04 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (524s left)
2021-03-29 16:15:05 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (523s left)
2021-03-29 16:15:06 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.2p1)
2021-03-29 16:15:07 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-29 16:15:11 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cloud-init status --help'
2021-03-29 16:15:13 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: OpenstackInstance(instance_id=dd110ec6-8bd7-4924-991d-5da2c33b1af2)
2021-03-29 16:16:00 INFO      integration_testing:clouds.py:171 Launched instance: OpenstackInstance(instance_id=dd110ec6-8bd7-4924-991d-5da2c33b1af2)
2021-03-29 16:16:00 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 20.3-2-g371b392c-0ubuntu1~20.04.1
2021-03-29 16:16:02 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 20.3-2-g371b392c-0ubuntu1~20.04.1
2021-03-29 16:16:02 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20201117
2021-03-29 16:16:02 INFO      integration_testing:clouds.py:181 image serial: 20201117
2021-03-29 16:16:02 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
2021-03-29 16:16:02 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'dpkg-query --show cloud-init'
2021-03-29 16:16:02 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /run/cloud-init/result.json'
2021-03-29 16:16:02 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init init'
2021-03-29 16:16:04 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep Trace /var/log/cloud-init.log'
2021-03-29 16:16:04 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c cloud-id
2021-03-29 16:16:05 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /etc/netplan/50-cloud-init.yaml'
2021-03-29 16:16:06 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c systemd-analyze
2021-03-29 16:16:06 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'systemd-analyze blame'
2021-03-29 16:16:08 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze show'
2021-03-29 16:16:09 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze blame'
Installing proposed image
2021-03-29 16:16:10 INFO      integration_testing:instances.py:144 Installing proposed image
2021-03-29 16:16:10 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'echo deb "http://archive.ubuntu.com/ubuntu $(lsb_release -sc)-proposed main" | tee /etc/apt/sources.list.d/proposed.list
apt-get update -q
apt-get install -qy cloud-init'
2021-03-29 16:17:20 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init -v'
Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~20.04.1
2021-03-29 16:17:21 INFO      integration_testing:instances.py:136 Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~20.04.1
2021-03-29 16:17:21 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-29 16:17:22 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-03-29 16:17:22 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'hostname something-else'
Restarting instance and waiting for boot
2021-03-29 16:17:22 INFO      integration_testing:instances.py:65 Restarting instance and waiting for boot
2021-03-29 16:17:40 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-03-29 16:17:44 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (596s left)
2021-03-29 16:17:48 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (592s left)
2021-03-29 16:17:52 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (588s left)
2021-03-29 16:17:56 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (584s left)
2021-03-29 16:18:00 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (580s left)
2021-03-29 16:18:04 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (576s left)
2021-03-29 16:18:08 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (572s left)
2021-03-29 16:18:09 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (571s left)
2021-03-29 16:18:10 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (570s left)
2021-03-29 16:18:11 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (569s left)
2021-03-29 16:18:12 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (568s left)
2021-03-29 16:18:13 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (567s left)
2021-03-29 16:18:14 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (566s left)
2021-03-29 16:18:15 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (564s left)
2021-03-29 16:18:16 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (563s left)
2021-03-29 16:18:17 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (562s left)
2021-03-29 16:18:19 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (561s left)
2021-03-29 16:18:20 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (560s left)
2021-03-29 16:18:24 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (556s left)
2021-03-29 16:18:25 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (555s left)
2021-03-29 16:18:26 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (554s left)
2021-03-29 16:18:27 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (553s left)
2021-03-29 16:18:28 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (552s left)
2021-03-29 16:18:29 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.189
Retrying SSH connection to ubuntu@10.245.164.189:22 (551s left)
2021-03-29 16:18:30 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.2p1)
2021-03-29 16:18:31 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-29 16:18:36 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cloud-init status --help'
2021-03-29 16:18:39 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
2021-03-29 16:18:42 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init status --wait --long'
2021-03-29 16:18:43 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
2021-03-29 16:18:44 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'dpkg-query --show cloud-init'
2021-03-29 16:18:44 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /run/cloud-init/result.json'
2021-03-29 16:18:44 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init init'
2021-03-29 16:18:46 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep Trace /var/log/cloud-init.log'
2021-03-29 16:18:46 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c cloud-id
2021-03-29 16:18:47 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /etc/netplan/50-cloud-init.yaml'
2021-03-29 16:18:47 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c systemd-analyze
2021-03-29 16:18:47 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'systemd-analyze blame'
2021-03-29 16:18:49 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze show'
2021-03-29 16:18:50 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze blame'
Wrote upgrade test logs to /tmp/cloud_init_test_logs/test_upgrade_openstack_focal_before_210329111322.log and /tmp/cloud_init_test_logs/test_upgrade_openstack_focal_after_210329111322.log
2021-03-29 16:18:57 INFO      integration_testing:test_upgrade.py:98 Wrote upgrade test logs to /tmp/cloud_init_test_logs/test_upgrade_openstack_focal_before_210329111322.log and /tmp/cloud_init_test_logs/test_upgrade_openstack_focal_after_210329111322.log
PASSED

=============================== warnings summary ===============================
tests/integration_tests/test_upgrade.py: 44 tests with warnings
  /home/james/envs/cloud-init/lib/python3.5/site-packages/openstack/resource.py:351: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() instead
    len(inspect.getargspec(type_).args) > 1)

-- Docs: https://docs.pytest.org/en/latest/warnings.html
================== 1 passed, 44 warnings in 335.64s (0:05:35) ==================


==== Groovy ====
============================= test session starts ==============================
platform linux -- Python 3.5.9, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /home/james/cloud-init-tests, inifile: tox.ini
plugins: cov-2.9.0
collected 1 item

tests/integration_tests/test_upgrade.py::test_upgrade Detected image: image_id=e2bef761-ee11-4b06-8792-f95e0d07a2bd os=ubuntu release=groovy

-------------------------------- live log setup --------------------------------
2021-03-29 16:21:28 INFO      integration_testing:clouds.py:87 Detected image: image_id=e2bef761-ee11-4b06-8792-f95e0d07a2bd os=ubuntu release=groovy
Detected image: image_id=e2bef761-ee11-4b06-8792-f95e0d07a2bd os=ubuntu release=groovy
2021-03-29 16:21:28 INFO      integration_testing:clouds.py:87 Detected image: image_id=e2bef761-ee11-4b06-8792-f95e0d07a2bd os=ubuntu release=groovy
Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=e2bef761-ee11-4b06-8792-f95e0d07a2bd::ubuntu::groovy
PLATFORM=openstack
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
2021-03-29 16:21:28 INFO      integration_testing:clouds.py:128 Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=e2bef761-ee11-4b06-8792-f95e0d07a2bd::ubuntu::groovy
PLATFORM=openstack
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
Detected image: image_id=e2bef761-ee11-4b06-8792-f95e0d07a2bd os=ubuntu release=groovy
-------------------------------- live log call ---------------------------------
2021-03-29 16:21:28 INFO      integration_testing:clouds.py:87 Detected image: image_id=e2bef761-ee11-4b06-8792-f95e0d07a2bd os=ubuntu release=groovy
Detected image: image_id=e2bef761-ee11-4b06-8792-f95e0d07a2bd os=ubuntu release=groovy
2021-03-29 16:21:28 INFO      integration_testing:clouds.py:87 Detected image: image_id=e2bef761-ee11-4b06-8792-f95e0d07a2bd os=ubuntu release=groovy
Launching instance with launch_kwargs:
image_id=e2bef761-ee11-4b06-8792-f95e0d07a2bd
user_data=#cloud-config
hostname: SRU-worked

2021-03-29 16:21:28 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
image_id=e2bef761-ee11-4b06-8792-f95e0d07a2bd
user_data=#cloud-config
hostname: SRU-worked

2021-03-29 16:22:17 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-03-29 16:22:20 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (596s left)
2021-03-29 16:22:25 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (592s left)
2021-03-29 16:22:26 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (591s left)
2021-03-29 16:22:27 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (590s left)
2021-03-29 16:22:28 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (589s left)
2021-03-29 16:22:29 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (588s left)
2021-03-29 16:22:30 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (587s left)
2021-03-29 16:22:31 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (586s left)
2021-03-29 16:22:32 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (585s left)
2021-03-29 16:22:33 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (584s left)
2021-03-29 16:22:34 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (583s left)
2021-03-29 16:22:35 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (582s left)
2021-03-29 16:22:36 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (580s left)
2021-03-29 16:22:37 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (579s left)
2021-03-29 16:22:38 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (578s left)
2021-03-29 16:22:39 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (577s left)
2021-03-29 16:22:41 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (576s left)
2021-03-29 16:22:42 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (575s left)
2021-03-29 16:22:43 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (574s left)
2021-03-29 16:22:44 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (573s left)
2021-03-29 16:22:45 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (572s left)
2021-03-29 16:22:46 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (571s left)
2021-03-29 16:22:47 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (570s left)
2021-03-29 16:22:48 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (569s left)
2021-03-29 16:22:49 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (568s left)
2021-03-29 16:22:50 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (567s left)
2021-03-29 16:22:51 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.3p1)
2021-03-29 16:22:51 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-29 16:22:53 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cloud-init status --help'
2021-03-29 16:22:54 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: OpenstackInstance(instance_id=b7c0d2cc-5fe2-407a-9d9e-16cbacc08189)
2021-03-29 16:22:56 INFO      integration_testing:clouds.py:171 Launched instance: OpenstackInstance(instance_id=b7c0d2cc-5fe2-407a-9d9e-16cbacc08189)
2021-03-29 16:22:56 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 20.3-15-g6d332e5c-0ubuntu1
2021-03-29 16:22:56 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 20.3-15-g6d332e5c-0ubuntu1
2021-03-29 16:22:56 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20201118
2021-03-29 16:22:56 INFO      integration_testing:clouds.py:181 image serial: 20201118
2021-03-29 16:22:56 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
2021-03-29 16:22:56 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'dpkg-query --show cloud-init'
2021-03-29 16:22:56 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /run/cloud-init/result.json'
2021-03-29 16:22:57 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init init'
2021-03-29 16:22:57 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep Trace /var/log/cloud-init.log'
2021-03-29 16:22:58 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c cloud-id
2021-03-29 16:22:58 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /etc/netplan/50-cloud-init.yaml'
2021-03-29 16:22:58 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c systemd-analyze
2021-03-29 16:22:58 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'systemd-analyze blame'
2021-03-29 16:22:59 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze show'
2021-03-29 16:23:00 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze blame'
Installing proposed image
2021-03-29 16:23:00 INFO      integration_testing:instances.py:144 Installing proposed image
2021-03-29 16:23:00 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'echo deb "http://archive.ubuntu.com/ubuntu $(lsb_release -sc)-proposed main" | tee /etc/apt/sources.list.d/proposed.list
apt-get update -q
apt-get install -qy cloud-init'
2021-03-29 16:23:24 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init -v'
Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~20.10.1
2021-03-29 16:23:25 INFO      integration_testing:instances.py:136 Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~20.10.1
2021-03-29 16:23:25 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-29 16:23:26 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-03-29 16:23:26 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'hostname something-else'
Restarting instance and waiting for boot
2021-03-29 16:23:26 INFO      integration_testing:instances.py:65 Restarting instance and waiting for boot
2021-03-29 16:23:39 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-03-29 16:23:46 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (592s left)
2021-03-29 16:23:47 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (591s left)
2021-03-29 16:23:48 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (590s left)
2021-03-29 16:23:49 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (589s left)
2021-03-29 16:23:50 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (588s left)
2021-03-29 16:23:51 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (587s left)
2021-03-29 16:23:52 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (586s left)
2021-03-29 16:23:53 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (585s left)
2021-03-29 16:23:54 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (584s left)
2021-03-29 16:23:55 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (583s left)
2021-03-29 16:23:56 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (582s left)
2021-03-29 16:23:57 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (581s left)
2021-03-29 16:23:59 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.245.164.224
Retrying SSH connection to ubuntu@10.245.164.224:22 (580s left)
2021-03-29 16:24:00 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.3p1)
2021-03-29 16:24:00 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-29 16:24:02 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cloud-init status --help'
2021-03-29 16:24:03 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
2021-03-29 16:24:04 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init status --wait --long'
2021-03-29 16:24:04 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
2021-03-29 16:24:04 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'dpkg-query --show cloud-init'
2021-03-29 16:24:05 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /run/cloud-init/result.json'
2021-03-29 16:24:05 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init init'
2021-03-29 16:24:05 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep Trace /var/log/cloud-init.log'
2021-03-29 16:24:06 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c cloud-id
2021-03-29 16:24:06 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /etc/netplan/50-cloud-init.yaml'
2021-03-29 16:24:06 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c systemd-analyze
2021-03-29 16:24:06 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'systemd-analyze blame'
2021-03-29 16:24:07 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze show'
2021-03-29 16:24:08 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init analyze blame'
Wrote upgrade test logs to /tmp/cloud_init_test_logs/test_upgrade_openstack_groovy_before_210329112128.log and /tmp/cloud_init_test_logs/test_upgrade_openstack_groovy_after_210329112128.log
2021-03-29 16:24:14 INFO      integration_testing:test_upgrade.py:98 Wrote upgrade test logs to /tmp/cloud_init_test_logs/test_upgrade_openstack_groovy_before_210329112128.log and /tmp/cloud_init_test_logs/test_upgrade_openstack_groovy_after_210329112128.log
PASSED

=============================== warnings summary ===============================
tests/integration_tests/test_upgrade.py: 44 tests with warnings
  /home/james/envs/cloud-init/lib/python3.5/site-packages/openstack/resource.py:351: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() instead
    len(inspect.getargspec(type_).args) > 1)

-- Docs: https://docs.pytest.org/en/latest/warnings.html
================== 1 passed, 44 warnings in 165.61s (0:02:45) ==================
