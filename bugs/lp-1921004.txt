https://github.com/canonical/cloud-init/commit/45db197c

=== Begin SRU Template ===
[Impact]
An 'prefer_fqdn_over_hostname' config option was added to allow user control
of distro hostname selection if both short hostname and FQDN are supplied.
If `prefer_fqdn_over_hostname` is true the FQDN will be selected as
hostname; if false the hostname will be selectedA new config option was added

[Test Case]
There is an upstream test for this bug:
https://github.com/canonical/cloud-init/blob/master/tests/integration_tests/modules/test_set_hostname.py::TestHostname

=== Bionic ===
============================= test session starts ==============================
platform linux -- Python 3.5.10, pytest-6.1.2, py-1.10.0, pluggy-0.13.1
rootdir: /home/james/cloud-init-tests, configfile: tox.ini
plugins: cov-2.11.1
collected 4 items

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_hostname Detected image: image_id=bionic os=ubuntu release=bionic

-------------------------------- live log setup --------------------------------
2021-05-14 21:02:17 INFO      integration_testing:clouds.py:88 Detected image: image_id=bionic os=ubuntu release=bionic
Detected image: image_id=bionic os=ubuntu release=bionic
2021-05-14 21:02:17 INFO      integration_testing:clouds.py:88 Detected image: image_id=bionic os=ubuntu release=bionic
Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=ALWAYS
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=bionic
PLATFORM=lxd_vm
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
2021-05-14 21:02:24 INFO      integration_testing:clouds.py:129 Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=ALWAYS
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=bionic
PLATFORM=lxd_vm
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
Setting up environment for lxd_vm
2021-05-14 21:02:24 INFO      integration_testing:conftest.py:156 Setting up environment for lxd_vm
Launching instance with launch_kwargs:
image_id=ubuntu:4fb318cb190fc599b788584d5088c8a64bb32bbc5d8a429cac60263bddf4c7f5
user_data=None
2021-05-14 21:02:24 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=ubuntu:4fb318cb190fc599b788584d5088c8a64bb32bbc5d8a429cac60263bddf4c7f5
user_data=None
The profile named pycloudlib-vm-bionic-v2 already exists
['lxc', 'init', 'ubuntu:4fb318cb190fc599b788584d5088c8a64bb32bbc5d8a429cac60263bddf4c7f5', '--profile', 'pycloudlib-vm-bionic-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--vm']
2021-05-14 21:02:26 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-14 21:02:50 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.13
Retrying SSH connection to ubuntu@10.37.179.13:22 (575s left)
2021-05-14 21:02:52 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.13
Retrying SSH connection to ubuntu@10.37.179.13:22 (574s left)
2021-05-14 21:02:53 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.13
Retrying SSH connection to ubuntu@10.37.179.13:22 (573s left)
2021-05-14 21:02:54 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.6p1)
2021-05-14 21:02:54 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-14 21:02:55 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=wise-ghoul)
2021-05-14 21:02:58 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=wise-ghoul)
2021-05-14 21:02:58 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
2021-05-14 21:02:59 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.6p1)
2021-05-14 21:02:59 INFO      paramiko.transport:transport.py:1819 Auth banner: b'System is going down.\n\n'
2021-05-14 21:02:59 INFO      pycloudlib.instance:instance.py:343 No existing session
Retrying SSH connection to ubuntu@10.37.179.13:22 (599s left)
2021-05-14 21:03:31 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.6p1)
2021-05-14 21:03:31 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~18.04.2
2021-05-14 21:03:32 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~18.04.2
2021-05-14 21:03:32 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210512
2021-05-14 21:03:32 INFO      integration_testing:clouds.py:183 image serial: 20210512
Installing proposed image
2021-05-14 21:03:32 INFO      integration_testing:instances.py:144 Installing proposed image
2021-05-14 21:03:32 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'echo deb "http://archive.ubuntu.com/ubuntu $(lsb_release -sc)-proposed main" | tee /etc/apt/sources.list.d/proposed.list
apt-get update -q
apt-get install -qy cloud-init'
2021-05-14 21:03:46 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init -v'
Installed cloud-init version: 21.2-3-g899bfaa9-0ubuntu2~18.04.1
2021-05-14 21:03:46 INFO      integration_testing:instances.py:136 Installed cloud-init version: 21.2-3-g899bfaa9-0ubuntu2~18.04.1
2021-05-14 21:03:46 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-05-14 21:03:46 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-05-14 21:03:46 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-05-14 21:03:47 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-05-14 21:03:47 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-05-14 21:03:47 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
Created new image: local:wise-ghoul-snapshot
2021-05-14 21:05:01 INFO      integration_testing:instances.py:113 Created new image: local:wise-ghoul-snapshot
Done with environment setup
2021-05-14 21:05:01 INFO      integration_testing:conftest.py:162 Done with environment setup
Launching instance with launch_kwargs:
image_id=local:wise-ghoul-snapshot
user_data=#cloud-config
hostname: cloudinit2

2021-05-14 21:05:01 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:wise-ghoul-snapshot
user_data=#cloud-config
hostname: cloudinit2

['lxc', 'init', 'local:wise-ghoul-snapshot', '--profile', 'pycloudlib-vm-bionic-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nhostname: cloudinit2\n', '--vm']
2021-05-14 21:06:06 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-14 21:06:54 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.194
Retrying SSH connection to ubuntu@10.37.179.194:22 (552s left)
2021-05-14 21:06:56 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.194
Retrying SSH connection to ubuntu@10.37.179.194:22 (550s left)
2021-05-14 21:06:57 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.6p1)
2021-05-14 21:06:57 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-14 21:06:57 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=super-racer)
2021-05-14 21:06:59 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=super-racer)
2021-05-14 21:06:59 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~18.04.1
2021-05-14 21:06:59 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~18.04.1
2021-05-14 21:06:59 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210512
2021-05-14 21:06:59 INFO      integration_testing:clouds.py:183 image serial: 20210512
-------------------------------- live log call ---------------------------------
2021-05-14 21:06:59 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
PASSED
------------------------------ live log teardown -------------------------------
2021-05-14 21:06:59 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210514160217/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname
2021-05-14 21:07:00 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210514160217/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname
2021-05-14 21:07:00 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/bd56eb7f-1f8a-4ac5-9251-c3e78ce0f17e.tmp'
2021-05-14 21:07:00 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] Opened sftp connection (server version 3)

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_prefer_fqdn Detected image: image_id=bionic os=ubuntu release=bionic

-------------------------------- live log setup --------------------------------
2021-05-14 21:07:00 INFO      integration_testing:clouds.py:88 Detected image: image_id=bionic os=ubuntu release=bionic
Launching instance with launch_kwargs:
image_id=local:wise-ghoul-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: True
hostname: cloudinit1
fqdn: cloudinit2.test.io

2021-05-14 21:07:00 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:wise-ghoul-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: True
hostname: cloudinit1
fqdn: cloudinit2.test.io

2021-05-14 21:07:00 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] sftp session closed.
['lxc', 'init', 'local:wise-ghoul-snapshot', '--profile', 'pycloudlib-vm-bionic-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nprefer_fqdn_over_hostname: True\nhostname: cloudinit1\nfqdn: cloudinit2.test.io\n', '--vm']
2021-05-14 21:07:01 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-14 21:07:50 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.111
Retrying SSH connection to ubuntu@10.37.179.111:22 (550s left)
2021-05-14 21:07:52 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.6p1)
2021-05-14 21:07:52 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-14 21:07:53 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=tidy-gnu)
2021-05-14 21:07:54 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=tidy-gnu)
2021-05-14 21:07:54 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~18.04.1
2021-05-14 21:07:54 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~18.04.1
2021-05-14 21:07:54 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210512
2021-05-14 21:07:55 INFO      integration_testing:clouds.py:183 image serial: 20210512
-------------------------------- live log call ---------------------------------
2021-05-14 21:07:55 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
PASSED
------------------------------ live log teardown -------------------------------
2021-05-14 21:07:55 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210514160217/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_fqdn
2021-05-14 21:07:55 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210514160217/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_fqdn
2021-05-14 21:07:55 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/6fc88432-a712-409c-b694-c82b31723b29.tmp'
2021-05-14 21:07:55 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] Opened sftp connection (server version 3)

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_prefer_short_hostname Detected image: image_id=bionic os=ubuntu release=bionic

-------------------------------- live log setup --------------------------------
2021-05-14 21:07:56 INFO      integration_testing:clouds.py:88 Detected image: image_id=bionic os=ubuntu release=bionic
Launching instance with launch_kwargs:
image_id=local:wise-ghoul-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: False
hostname: cloudinit1
fqdn: cloudinit2.test.io

2021-05-14 21:07:56 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:wise-ghoul-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: False
hostname: cloudinit1
fqdn: cloudinit2.test.io

['lxc', 'init', 'local:wise-ghoul-snapshot', '--profile', 'pycloudlib-vm-bionic-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nprefer_fqdn_over_hostname: False\nhostname: cloudinit1\nfqdn: cloudinit2.test.io\n', '--vm']
2021-05-14 21:07:56 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-14 21:08:44 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.172
Retrying SSH connection to ubuntu@10.37.179.172:22 (552s left)
2021-05-14 21:08:46 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.172
Retrying SSH connection to ubuntu@10.37.179.172:22 (550s left)
2021-05-14 21:08:47 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.6p1)
2021-05-14 21:08:47 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-14 21:08:48 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=stirring-satyr)
2021-05-14 21:08:49 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=stirring-satyr)
2021-05-14 21:08:49 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~18.04.1
2021-05-14 21:08:49 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~18.04.1
2021-05-14 21:08:49 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
2021-05-14 21:08:49 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] sftp session closed.
image serial: 20210512
2021-05-14 21:08:49 INFO      integration_testing:clouds.py:183 image serial: 20210512
-------------------------------- live log call ---------------------------------
2021-05-14 21:08:49 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
PASSED
------------------------------ live log teardown -------------------------------
2021-05-14 21:08:49 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210514160217/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_short_hostname
2021-05-14 21:08:50 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210514160217/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_short_hostname
2021-05-14 21:08:50 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/c7e00e32-8f6e-430e-8478-9199386b2a24.tmp'
2021-05-14 21:08:50 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] Opened sftp connection (server version 3)

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_hostname_and_fqdn Detected image: image_id=bionic os=ubuntu release=bionic

-------------------------------- live log setup --------------------------------
2021-05-14 21:08:50 INFO      integration_testing:clouds.py:88 Detected image: image_id=bionic os=ubuntu release=bionic
Launching instance with launch_kwargs:
image_id=local:wise-ghoul-snapshot
user_data=#cloud-config
manage_etc_hosts: true
hostname: cloudinit1
fqdn: cloudinit2.i9n.cloud-init.io

2021-05-14 21:08:50 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:wise-ghoul-snapshot
user_data=#cloud-config
manage_etc_hosts: true
hostname: cloudinit1
fqdn: cloudinit2.i9n.cloud-init.io

['lxc', 'init', 'local:wise-ghoul-snapshot', '--profile', 'pycloudlib-vm-bionic-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nmanage_etc_hosts: true\nhostname: cloudinit1\nfqdn: cloudinit2.i9n.cloud-init.io\n', '--vm']
2021-05-14 21:08:51 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-14 21:09:38 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.55
Retrying SSH connection to ubuntu@10.37.179.55:22 (552s left)
2021-05-14 21:09:40 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.55
Retrying SSH connection to ubuntu@10.37.179.55:22 (550s left)
2021-05-14 21:09:41 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.6p1)
2021-05-14 21:09:41 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-14 21:09:42 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=frank-duck)
2021-05-14 21:09:44 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=frank-duck)
2021-05-14 21:09:44 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~18.04.1
2021-05-14 21:09:44 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~18.04.1
2021-05-14 21:09:44 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210512
2021-05-14 21:09:44 INFO      integration_testing:clouds.py:183 image serial: 20210512
-------------------------------- live log call ---------------------------------
2021-05-14 21:09:44 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
2021-05-14 21:09:44 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'hostname --fqdn'
2021-05-14 21:09:44 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep ^127 /etc/hosts'
PASSED
------------------------------ live log teardown -------------------------------
2021-05-14 21:09:44 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210514160217/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname_and_fqdn
2021-05-14 21:09:45 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210514160217/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname_and_fqdn
2021-05-14 21:09:45 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/8ddfcbcc-a369-4a38-9937-fa269a9e5d82.tmp'
2021-05-14 21:09:45 INFO      paramiko.transport.sftp:sftp.py:158 [chan 9] Opened sftp connection (server version 3)
Deleting snapshot image created for this testrun: local:wise-ghoul-snapshot
2021-05-14 21:09:45 INFO      integration_testing:clouds.py:204 Deleting snapshot image created for this testrun: local:wise-ghoul-snapshot


=============================== warnings summary ===============================
../envs/cloud-init/lib/python3.5/site-packages/jwt/utils.py:8
  /home/james/envs/cloud-init/lib/python3.5/site-packages/jwt/utils.py:8: CryptographyDeprecationWarning: Python 3.5 support will be dropped in the next release of cryptography. Please upgrade your Python.
    from cryptography.hazmat.primitives.asymmetric.utils import (

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_hostname
  /home/james/envs/cloud-init/lib/python3.5/site-packages/simplestreams/mirrors/__init__.py:207: DeprecationWarning: The 'warn' method is deprecated, use 'warning' instead
    self.prefix, path)

-- Docs: https://docs.pytest.org/en/stable/warnings.html
================== 4 passed, 2 warnings in 448.55s (0:07:28) ===================


=== Focal ===
============================= test session starts ==============================
platform linux -- Python 3.5.10, pytest-6.1.2, py-1.10.0, pluggy-0.13.1
rootdir: /home/james/cloud-init-tests, configfile: tox.ini
plugins: cov-2.11.1
collected 4 items

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_hostname Detected image: image_id=focal os=ubuntu release=focal

-------------------------------- live log setup --------------------------------
2021-05-14 21:26:12 INFO      integration_testing:clouds.py:88 Detected image: image_id=focal os=ubuntu release=focal
Detected image: image_id=focal os=ubuntu release=focal
2021-05-14 21:26:12 INFO      integration_testing:clouds.py:88 Detected image: image_id=focal os=ubuntu release=focal
Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=ALWAYS
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=focal
PLATFORM=lxd_vm
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
2021-05-14 21:26:18 INFO      integration_testing:clouds.py:129 Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=ALWAYS
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=focal
PLATFORM=lxd_vm
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
Setting up environment for lxd_vm
2021-05-14 21:26:18 INFO      integration_testing:conftest.py:156 Setting up environment for lxd_vm
Launching instance with launch_kwargs:
image_id=ubuntu:f217de8a505d919f42cac6a898ac66fdf582b8ccc092d73189b46101615f3612
user_data=None
2021-05-14 21:26:18 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=ubuntu:f217de8a505d919f42cac6a898ac66fdf582b8ccc092d73189b46101615f3612
user_data=None
The profile named pycloudlib-vm-focal-v2 already exists
['lxc', 'init', 'ubuntu:f217de8a505d919f42cac6a898ac66fdf582b8ccc092d73189b46101615f3612', '--profile', 'pycloudlib-vm-focal-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--vm']
2021-05-14 21:26:21 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-14 21:26:42 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.10
Retrying SSH connection to ubuntu@10.37.179.10:22 (578s left)
2021-05-14 21:26:44 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.10
Retrying SSH connection to ubuntu@10.37.179.10:22 (577s left)
2021-05-14 21:26:45 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.10
Retrying SSH connection to ubuntu@10.37.179.10:22 (576s left)
2021-05-14 21:26:47 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.10
Retrying SSH connection to ubuntu@10.37.179.10:22 (574s left)
2021-05-14 21:26:48 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.2p1)
2021-05-14 21:26:48 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-14 21:26:49 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=refined-grub)
2021-05-14 21:26:52 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=refined-grub)
2021-05-14 21:26:52 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~20.04.2
2021-05-14 21:26:52 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~20.04.2
2021-05-14 21:26:52 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210510
2021-05-14 21:26:52 INFO      integration_testing:clouds.py:183 image serial: 20210510
Installing proposed image
2021-05-14 21:26:52 INFO      integration_testing:instances.py:144 Installing proposed image
2021-05-14 21:26:52 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'echo deb "http://archive.ubuntu.com/ubuntu $(lsb_release -sc)-proposed main" | tee /etc/apt/sources.list.d/proposed.list
apt-get update -q
apt-get install -qy cloud-init'
2021-05-14 21:27:07 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init -v'
Installed cloud-init version: 21.2-3-g899bfaa9-0ubuntu2~20.04.1
2021-05-14 21:27:08 INFO      integration_testing:instances.py:136 Installed cloud-init version: 21.2-3-g899bfaa9-0ubuntu2~20.04.1
2021-05-14 21:27:08 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-05-14 21:27:08 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-05-14 21:27:08 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-05-14 21:27:08 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-05-14 21:27:08 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-05-14 21:27:09 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
Created new image: local:refined-grub-snapshot
2021-05-14 21:28:33 INFO      integration_testing:instances.py:113 Created new image: local:refined-grub-snapshot
Done with environment setup
2021-05-14 21:28:33 INFO      integration_testing:conftest.py:162 Done with environment setup
Launching instance with launch_kwargs:
image_id=local:refined-grub-snapshot
user_data=#cloud-config
hostname: cloudinit2

2021-05-14 21:28:33 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:refined-grub-snapshot
user_data=#cloud-config
hostname: cloudinit2

['lxc', 'init', 'local:refined-grub-snapshot', '--profile', 'pycloudlib-vm-focal-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nhostname: cloudinit2\n', '--vm']
2021-05-14 21:29:35 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-14 21:29:54 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.71
Retrying SSH connection to ubuntu@10.37.179.71:22 (581s left)
2021-05-14 21:29:55 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.71
Retrying SSH connection to ubuntu@10.37.179.71:22 (579s left)
2021-05-14 21:29:56 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.2p1)
2021-05-14 21:29:57 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-14 21:29:58 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=epic-seal)
2021-05-14 21:30:00 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=epic-seal)
2021-05-14 21:30:00 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.04.1
2021-05-14 21:30:00 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.04.1
2021-05-14 21:30:00 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210510
2021-05-14 21:30:00 INFO      integration_testing:clouds.py:183 image serial: 20210510
-------------------------------- live log call ---------------------------------
2021-05-14 21:30:00 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
PASSED
------------------------------ live log teardown -------------------------------
2021-05-14 21:30:00 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210514162612/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname
2021-05-14 21:30:01 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210514162612/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname
2021-05-14 21:30:01 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/741f176f-96d7-4a1a-a283-3cf2668aeeec.tmp'
2021-05-14 21:30:01 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] Opened sftp connection (server version 3)

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_prefer_fqdn Detected image: image_id=focal os=ubuntu release=focal

-------------------------------- live log setup --------------------------------
2021-05-14 21:30:01 INFO      integration_testing:clouds.py:88 Detected image: image_id=focal os=ubuntu release=focal
Launching instance with launch_kwargs:
image_id=local:refined-grub-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: True
hostname: cloudinit1
fqdn: cloudinit2.test.io

2021-05-14 21:30:01 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:refined-grub-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: True
hostname: cloudinit1
fqdn: cloudinit2.test.io

['lxc', 'init', 'local:refined-grub-snapshot', '--profile', 'pycloudlib-vm-focal-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nprefer_fqdn_over_hostname: True\nhostname: cloudinit1\nfqdn: cloudinit2.test.io\n', '--vm']
2021-05-14 21:30:02 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-14 21:30:21 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.205
Retrying SSH connection to ubuntu@10.37.179.205:22 (581s left)
2021-05-14 21:30:22 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.205
Retrying SSH connection to ubuntu@10.37.179.205:22 (579s left)
2021-05-14 21:30:24 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.2p1)
2021-05-14 21:30:24 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-14 21:30:25 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=tidy-worm)
2021-05-14 21:30:27 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=tidy-worm)
2021-05-14 21:30:27 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.04.1
2021-05-14 21:30:27 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.04.1
2021-05-14 21:30:27 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210510
2021-05-14 21:30:27 INFO      integration_testing:clouds.py:183 image serial: 20210510
-------------------------------- live log call ---------------------------------
2021-05-14 21:30:27 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
PASSED
------------------------------ live log teardown -------------------------------
2021-05-14 21:30:27 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210514162612/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_fqdn
2021-05-14 21:30:28 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210514162612/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_fqdn
2021-05-14 21:30:28 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/4e4fc744-941f-46e2-9366-56b9a1ebfc14.tmp'
2021-05-14 21:30:28 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] Opened sftp connection (server version 3)

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_prefer_short_hostname Detected image: image_id=focal os=ubuntu release=focal

-------------------------------- live log setup --------------------------------
2021-05-14 21:30:28 INFO      integration_testing:clouds.py:88 Detected image: image_id=focal os=ubuntu release=focal
Launching instance with launch_kwargs:
image_id=local:refined-grub-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: False
hostname: cloudinit1
fqdn: cloudinit2.test.io

2021-05-14 21:30:28 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:refined-grub-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: False
hostname: cloudinit1
fqdn: cloudinit2.test.io

2021-05-14 21:30:28 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] sftp session closed.
['lxc', 'init', 'local:refined-grub-snapshot', '--profile', 'pycloudlib-vm-focal-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nprefer_fqdn_over_hostname: False\nhostname: cloudinit1\nfqdn: cloudinit2.test.io\n', '--vm']
2021-05-14 21:30:29 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-14 21:30:47 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.232
Retrying SSH connection to ubuntu@10.37.179.232:22 (581s left)
2021-05-14 21:30:49 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.232
Retrying SSH connection to ubuntu@10.37.179.232:22 (579s left)
2021-05-14 21:30:50 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.2p1)
2021-05-14 21:30:50 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-14 21:30:51 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=amused-cattle)
2021-05-14 21:30:53 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=amused-cattle)
2021-05-14 21:30:53 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.04.1
2021-05-14 21:30:53 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.04.1
2021-05-14 21:30:53 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210510
2021-05-14 21:30:53 INFO      integration_testing:clouds.py:183 image serial: 20210510
-------------------------------- live log call ---------------------------------
2021-05-14 21:30:53 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
PASSED
------------------------------ live log teardown -------------------------------
2021-05-14 21:30:53 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210514162612/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_short_hostname
2021-05-14 21:30:54 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210514162612/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_short_hostname
2021-05-14 21:30:54 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/300b260b-8753-4aea-a2d2-2c1c3a1b077f.tmp'
2021-05-14 21:30:54 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] Opened sftp connection (server version 3)

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_hostname_and_fqdn Detected image: image_id=focal os=ubuntu release=focal

-------------------------------- live log setup --------------------------------
2021-05-14 21:30:54 INFO      integration_testing:clouds.py:88 Detected image: image_id=focal os=ubuntu release=focal
Launching instance with launch_kwargs:
image_id=local:refined-grub-snapshot
user_data=#cloud-config
manage_etc_hosts: true
hostname: cloudinit1
fqdn: cloudinit2.i9n.cloud-init.io

2021-05-14 21:30:54 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:refined-grub-snapshot
user_data=#cloud-config
manage_etc_hosts: true
hostname: cloudinit1
fqdn: cloudinit2.i9n.cloud-init.io

['lxc', 'init', 'local:refined-grub-snapshot', '--profile', 'pycloudlib-vm-focal-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nmanage_etc_hosts: true\nhostname: cloudinit1\nfqdn: cloudinit2.i9n.cloud-init.io\n', '--vm']
2021-05-14 21:30:55 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-14 21:31:14 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.32
Retrying SSH connection to ubuntu@10.37.179.32:22 (581s left)
2021-05-14 21:31:15 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.32
Retrying SSH connection to ubuntu@10.37.179.32:22 (579s left)
2021-05-14 21:31:17 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.2p1)
2021-05-14 21:31:17 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-14 21:31:18 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=oriented-raccoon)
2021-05-14 21:31:20 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=oriented-raccoon)
2021-05-14 21:31:20 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
2021-05-14 21:31:20 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] sftp session closed.
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.04.1
2021-05-14 21:31:20 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.04.1
2021-05-14 21:31:20 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210510
2021-05-14 21:31:20 INFO      integration_testing:clouds.py:183 image serial: 20210510
-------------------------------- live log call ---------------------------------
2021-05-14 21:31:20 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
2021-05-14 21:31:20 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'hostname --fqdn'
2021-05-14 21:31:20 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep ^127 /etc/hosts'
PASSED
------------------------------ live log teardown -------------------------------
2021-05-14 21:31:20 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210514162612/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname_and_fqdn
2021-05-14 21:31:21 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210514162612/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname_and_fqdn
2021-05-14 21:31:21 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/e96de15a-0e97-4864-bec7-d3ff6213451b.tmp'
2021-05-14 21:31:21 INFO      paramiko.transport.sftp:sftp.py:158 [chan 9] Opened sftp connection (server version 3)
Deleting snapshot image created for this testrun: local:refined-grub-snapshot
2021-05-14 21:31:21 INFO      integration_testing:clouds.py:204 Deleting snapshot image created for this testrun: local:refined-grub-snapshot


=============================== warnings summary ===============================
../envs/cloud-init/lib/python3.5/site-packages/jwt/utils.py:8
  /home/james/envs/cloud-init/lib/python3.5/site-packages/jwt/utils.py:8: CryptographyDeprecationWarning: Python 3.5 support will be dropped in the next release of cryptography. Please upgrade your Python.
    from cryptography.hazmat.primitives.asymmetric.utils import (

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_hostname
  /home/james/envs/cloud-init/lib/python3.5/site-packages/simplestreams/mirrors/__init__.py:207: DeprecationWarning: The 'warn' method is deprecated, use 'warning' instead
    self.prefix, path)

-- Docs: https://docs.pytest.org/en/stable/warnings.html
================== 4 passed, 2 warnings in 309.99s (0:05:09) ===================


=== Groovy ===
============================= test session starts ==============================
platform linux -- Python 3.5.10, pytest-6.1.2, py-1.10.0, pluggy-0.13.1
rootdir: /home/james/cloud-init-tests, configfile: tox.ini
plugins: cov-2.11.1
collected 4 items

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_hostname Detected image: image_id=groovy os=ubuntu release=groovy

-------------------------------- live log setup --------------------------------
2021-05-14 21:44:48 INFO      integration_testing:clouds.py:88 Detected image: image_id=groovy os=ubuntu release=groovy
Detected image: image_id=groovy os=ubuntu release=groovy
2021-05-14 21:44:48 INFO      integration_testing:clouds.py:88 Detected image: image_id=groovy os=ubuntu release=groovy
Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=ALWAYS
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=groovy
PLATFORM=lxd_vm
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
2021-05-14 21:44:54 INFO      integration_testing:clouds.py:129 Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=ALWAYS
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=groovy
PLATFORM=lxd_vm
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
Setting up environment for lxd_vm
2021-05-14 21:44:54 INFO      integration_testing:conftest.py:156 Setting up environment for lxd_vm
Launching instance with launch_kwargs:
image_id=ubuntu:982a39044cfe9c5372e65bb762453f2a34b339e26cef3d817b59f46c6e55c2b0
user_data=None
2021-05-14 21:44:54 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=ubuntu:982a39044cfe9c5372e65bb762453f2a34b339e26cef3d817b59f46c6e55c2b0
user_data=None
The profile named pycloudlib-vm-groovy-v2 already exists
['lxc', 'init', 'ubuntu:982a39044cfe9c5372e65bb762453f2a34b339e26cef3d817b59f46c6e55c2b0', '--profile', 'pycloudlib-vm-groovy-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--vm']
2021-05-14 21:44:57 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-14 21:45:18 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.154
Retrying SSH connection to ubuntu@10.37.179.154:22 (579s left)
2021-05-14 21:45:20 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.154
Retrying SSH connection to ubuntu@10.37.179.154:22 (577s left)
2021-05-14 21:45:21 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.154
Retrying SSH connection to ubuntu@10.37.179.154:22 (575s left)
2021-05-14 21:45:23 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.3p1)
2021-05-14 21:45:23 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-14 21:45:25 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=apt-midge)
2021-05-14 21:45:29 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=apt-midge)
2021-05-14 21:45:29 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~20.10.2
2021-05-14 21:45:30 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~20.10.2
2021-05-14 21:45:30 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210511.1
2021-05-14 21:45:30 INFO      integration_testing:clouds.py:183 image serial: 20210511.1
Installing proposed image
2021-05-14 21:45:30 INFO      integration_testing:instances.py:144 Installing proposed image
2021-05-14 21:45:30 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'echo deb "http://archive.ubuntu.com/ubuntu $(lsb_release -sc)-proposed main" | tee /etc/apt/sources.list.d/proposed.list
apt-get update -q
apt-get install -qy cloud-init'
2021-05-14 21:45:44 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init -v'
Installed cloud-init version: 21.2-3-g899bfaa9-0ubuntu2~20.10.1
2021-05-14 21:45:44 INFO      integration_testing:instances.py:136 Installed cloud-init version: 21.2-3-g899bfaa9-0ubuntu2~20.10.1
2021-05-14 21:45:44 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-05-14 21:45:45 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-05-14 21:45:45 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-05-14 21:45:45 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-05-14 21:45:45 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-05-14 21:45:45 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
Created new image: local:apt-midge-snapshot
2021-05-14 21:47:10 INFO      integration_testing:instances.py:113 Created new image: local:apt-midge-snapshot
Done with environment setup
2021-05-14 21:47:10 INFO      integration_testing:conftest.py:162 Done with environment setup
Launching instance with launch_kwargs:
image_id=local:apt-midge-snapshot
user_data=#cloud-config
hostname: cloudinit2

2021-05-14 21:47:10 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:apt-midge-snapshot
user_data=#cloud-config
hostname: cloudinit2

['lxc', 'init', 'local:apt-midge-snapshot', '--profile', 'pycloudlib-vm-groovy-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nhostname: cloudinit2\n', '--vm']
2021-05-14 21:48:13 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-14 21:48:33 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.108
Retrying SSH connection to ubuntu@10.37.179.108:22 (580s left)
2021-05-14 21:48:34 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.3p1)
2021-05-14 21:48:34 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-14 21:48:36 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=nearby-bullfrog)
2021-05-14 21:48:38 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=nearby-bullfrog)
2021-05-14 21:48:38 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.10.1
2021-05-14 21:48:39 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.10.1
2021-05-14 21:48:39 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210511.1
2021-05-14 21:48:39 INFO      integration_testing:clouds.py:183 image serial: 20210511.1
-------------------------------- live log call ---------------------------------
2021-05-14 21:48:39 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
PASSED
------------------------------ live log teardown -------------------------------
2021-05-14 21:48:39 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210514164448/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname
2021-05-14 21:48:39 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210514164448/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname
2021-05-14 21:48:39 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/b81d8b57-089e-4226-8dab-d30dfe74570e.tmp'
2021-05-14 21:48:39 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] Opened sftp connection (server version 3)

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_prefer_fqdn Detected image: image_id=groovy os=ubuntu release=groovy

-------------------------------- live log setup --------------------------------
2021-05-14 21:48:40 INFO      integration_testing:clouds.py:88 Detected image: image_id=groovy os=ubuntu release=groovy
Launching instance with launch_kwargs:
image_id=local:apt-midge-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: True
hostname: cloudinit1
fqdn: cloudinit2.test.io

2021-05-14 21:48:40 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:apt-midge-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: True
hostname: cloudinit1
fqdn: cloudinit2.test.io

['lxc', 'init', 'local:apt-midge-snapshot', '--profile', 'pycloudlib-vm-groovy-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nprefer_fqdn_over_hostname: True\nhostname: cloudinit1\nfqdn: cloudinit2.test.io\n', '--vm']
2021-05-14 21:48:40 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-14 21:48:59 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.184
Retrying SSH connection to ubuntu@10.37.179.184:22 (581s left)
2021-05-14 21:49:00 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.184
Retrying SSH connection to ubuntu@10.37.179.184:22 (579s left)
2021-05-14 21:49:02 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.3p1)
2021-05-14 21:49:02 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-14 21:49:04 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=generous-loon)
2021-05-14 21:49:06 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=generous-loon)
2021-05-14 21:49:06 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.10.1
2021-05-14 21:49:07 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.10.1
2021-05-14 21:49:07 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210511.1
2021-05-14 21:49:07 INFO      integration_testing:clouds.py:183 image serial: 20210511.1
-------------------------------- live log call ---------------------------------
2021-05-14 21:49:07 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
PASSED
------------------------------ live log teardown -------------------------------
2021-05-14 21:49:07 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210514164448/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_fqdn
2021-05-14 21:49:07 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210514164448/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_fqdn
2021-05-14 21:49:07 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/7bdcd999-ca12-4c8b-9a01-4de6bf98ab2a.tmp'
2021-05-14 21:49:07 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] Opened sftp connection (server version 3)

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_prefer_short_hostname Detected image: image_id=groovy os=ubuntu release=groovy

-------------------------------- live log setup --------------------------------
2021-05-14 21:49:07 INFO      integration_testing:clouds.py:88 Detected image: image_id=groovy os=ubuntu release=groovy
Launching instance with launch_kwargs:
image_id=local:apt-midge-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: False
hostname: cloudinit1
fqdn: cloudinit2.test.io

2021-05-14 21:49:07 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:apt-midge-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: False
hostname: cloudinit1
fqdn: cloudinit2.test.io

2021-05-14 21:49:08 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] sftp session closed.
['lxc', 'init', 'local:apt-midge-snapshot', '--profile', 'pycloudlib-vm-groovy-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nprefer_fqdn_over_hostname: False\nhostname: cloudinit1\nfqdn: cloudinit2.test.io\n', '--vm']
2021-05-14 21:49:08 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-14 21:49:28 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.183
Retrying SSH connection to ubuntu@10.37.179.183:22 (580s left)
2021-05-14 21:49:29 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.183
Retrying SSH connection to ubuntu@10.37.179.183:22 (578s left)
2021-05-14 21:49:31 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.3p1)
2021-05-14 21:49:31 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-14 21:49:32 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=firm-gobbler)
2021-05-14 21:49:35 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=firm-gobbler)
2021-05-14 21:49:35 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.10.1
2021-05-14 21:49:35 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.10.1
2021-05-14 21:49:35 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210511.1
2021-05-14 21:49:35 INFO      integration_testing:clouds.py:183 image serial: 20210511.1
-------------------------------- live log call ---------------------------------
2021-05-14 21:49:35 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
PASSED
------------------------------ live log teardown -------------------------------
2021-05-14 21:49:35 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210514164448/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_short_hostname
2021-05-14 21:49:35 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210514164448/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_short_hostname
2021-05-14 21:49:35 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/2fab8f64-9c70-4390-a236-4266949734a6.tmp'
2021-05-14 21:49:35 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] Opened sftp connection (server version 3)

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_hostname_and_fqdn Detected image: image_id=groovy os=ubuntu release=groovy

-------------------------------- live log setup --------------------------------
2021-05-14 21:49:36 INFO      integration_testing:clouds.py:88 Detected image: image_id=groovy os=ubuntu release=groovy
Launching instance with launch_kwargs:
image_id=local:apt-midge-snapshot
user_data=#cloud-config
manage_etc_hosts: true
hostname: cloudinit1
fqdn: cloudinit2.i9n.cloud-init.io

2021-05-14 21:49:36 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:apt-midge-snapshot
user_data=#cloud-config
manage_etc_hosts: true
hostname: cloudinit1
fqdn: cloudinit2.i9n.cloud-init.io

['lxc', 'init', 'local:apt-midge-snapshot', '--profile', 'pycloudlib-vm-groovy-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nmanage_etc_hosts: true\nhostname: cloudinit1\nfqdn: cloudinit2.i9n.cloud-init.io\n', '--vm']
2021-05-14 21:49:36 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-14 21:49:56 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.241
Retrying SSH connection to ubuntu@10.37.179.241:22 (580s left)
2021-05-14 21:49:58 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.241
Retrying SSH connection to ubuntu@10.37.179.241:22 (578s left)
2021-05-14 21:50:00 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.3p1)
2021-05-14 21:50:00 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-14 21:50:01 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=daring-colt)
2021-05-14 21:50:03 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=daring-colt)
2021-05-14 21:50:03 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
2021-05-14 21:50:03 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] sftp session closed.
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.10.1
2021-05-14 21:50:03 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~20.10.1
2021-05-14 21:50:03 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210511.1
2021-05-14 21:50:03 INFO      integration_testing:clouds.py:183 image serial: 20210511.1
-------------------------------- live log call ---------------------------------
2021-05-14 21:50:03 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
2021-05-14 21:50:03 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'hostname --fqdn'
2021-05-14 21:50:03 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep ^127 /etc/hosts'
PASSED
------------------------------ live log teardown -------------------------------
2021-05-14 21:50:03 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210514164448/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname_and_fqdn
2021-05-14 21:50:04 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210514164448/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname_and_fqdn
2021-05-14 21:50:04 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/14f603c0-e053-45a8-b1ac-bf2090a529b3.tmp'
2021-05-14 21:50:04 INFO      paramiko.transport.sftp:sftp.py:158 [chan 9] Opened sftp connection (server version 3)
Deleting snapshot image created for this testrun: local:apt-midge-snapshot
2021-05-14 21:50:04 INFO      integration_testing:clouds.py:204 Deleting snapshot image created for this testrun: local:apt-midge-snapshot


=============================== warnings summary ===============================
../envs/cloud-init/lib/python3.5/site-packages/jwt/utils.py:8
  /home/james/envs/cloud-init/lib/python3.5/site-packages/jwt/utils.py:8: CryptographyDeprecationWarning: Python 3.5 support will be dropped in the next release of cryptography. Please upgrade your Python.
    from cryptography.hazmat.primitives.asymmetric.utils import (

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_hostname
  /home/james/envs/cloud-init/lib/python3.5/site-packages/simplestreams/mirrors/__init__.py:207: DeprecationWarning: The 'warn' method is deprecated, use 'warning' instead
    self.prefix, path)

-- Docs: https://docs.pytest.org/en/stable/warnings.html
================== 4 passed, 2 warnings in 316.45s (0:05:16) ===================


=== Hirsute ===
============================= test session starts ==============================
platform linux -- Python 3.5.10, pytest-6.1.2, py-1.10.0, pluggy-0.13.1
rootdir: /home/james/cloud-init-tests, configfile: tox.ini
plugins: cov-2.11.1
collected 4 items

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_hostname Detected image: image_id=hirsute os=ubuntu release=hirsute

-------------------------------- live log setup --------------------------------
2021-05-17 17:01:24 INFO      integration_testing:clouds.py:88 Detected image: image_id=hirsute os=ubuntu release=hirsute
Detected image: image_id=hirsute os=ubuntu release=hirsute
2021-05-17 17:01:24 INFO      integration_testing:clouds.py:88 Detected image: image_id=hirsute os=ubuntu release=hirsute
Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=ALWAYS
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=hirsute
PLATFORM=lxd_container
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
2021-05-17 17:01:30 INFO      integration_testing:clouds.py:129 Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=ALWAYS
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=hirsute
PLATFORM=lxd_container
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
Setting up environment for lxd_container
2021-05-17 17:01:30 INFO      integration_testing:conftest.py:156 Setting up environment for lxd_container
Launching instance with launch_kwargs:
image_id=ubuntu:8adad13e1e1185af6ad9efc0e8e9129cdd9d11d04a2751c140ecb94825048ad7
user_data=None
2021-05-17 17:01:30 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=ubuntu:8adad13e1e1185af6ad9efc0e8e9129cdd9d11d04a2751c140ecb94825048ad7
user_data=None
['lxc', 'init', 'ubuntu:8adad13e1e1185af6ad9efc0e8e9129cdd9d11d04a2751c140ecb94825048ad7', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n']
2021-05-17 17:01:34 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-17 17:01:37 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.253.153.239
Retrying SSH connection to ubuntu@10.253.153.239:22 (597s left)
2021-05-17 17:01:38 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.4p1)
2021-05-17 17:01:38 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-17 17:01:38 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=grown-kodiak)
2021-05-17 17:01:43 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=grown-kodiak)
2021-05-17 17:01:43 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu3
2021-05-17 17:01:43 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu3
2021-05-17 17:01:43 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210513
2021-05-17 17:01:43 INFO      integration_testing:clouds.py:183 image serial: 20210513
Installing proposed image
2021-05-17 17:01:43 INFO      integration_testing:instances.py:144 Installing proposed image
2021-05-17 17:01:43 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'echo deb "http://archive.ubuntu.com/ubuntu $(lsb_release -sc)-proposed main" | tee /etc/apt/sources.list.d/proposed.list
apt-get update -q
apt-get install -qy cloud-init'
2021-05-17 17:01:59 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init -v'
Installed cloud-init version: 21.2-3-g899bfaa9-0ubuntu2~21.04.1
2021-05-17 17:01:59 INFO      integration_testing:instances.py:136 Installed cloud-init version: 21.2-3-g899bfaa9-0ubuntu2~21.04.1
2021-05-17 17:01:59 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-05-17 17:01:59 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-05-17 17:01:59 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-05-17 17:01:59 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-05-17 17:01:59 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-05-17 17:02:00 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
Created new image: local:grown-kodiak-snapshot
2021-05-17 17:02:47 INFO      integration_testing:instances.py:113 Created new image: local:grown-kodiak-snapshot
Done with environment setup
2021-05-17 17:02:47 INFO      integration_testing:conftest.py:162 Done with environment setup
Launching instance with launch_kwargs:
image_id=local:grown-kodiak-snapshot
user_data=#cloud-config
hostname: cloudinit2

2021-05-17 17:02:47 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:grown-kodiak-snapshot
user_data=#cloud-config
hostname: cloudinit2

['lxc', 'init', 'local:grown-kodiak-snapshot', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nhostname: cloudinit2\n']
2021-05-17 17:03:01 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-17 17:03:02 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.253.153.225
Retrying SSH connection to ubuntu@10.253.153.225:22 (598s left)
2021-05-17 17:03:04 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.253.153.225
Retrying SSH connection to ubuntu@10.253.153.225:22 (597s left)
2021-05-17 17:03:05 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.4p1)
2021-05-17 17:03:05 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-17 17:03:05 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=tender-lobster)
2021-05-17 17:03:07 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=tender-lobster)
2021-05-17 17:03:07 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~21.04.1
2021-05-17 17:03:08 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~21.04.1
2021-05-17 17:03:08 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210513
2021-05-17 17:03:08 INFO      integration_testing:clouds.py:183 image serial: 20210513
-------------------------------- live log call ---------------------------------
2021-05-17 17:03:08 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
PASSED
------------------------------ live log teardown -------------------------------
2021-05-17 17:03:08 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210517120124/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname
2021-05-17 17:03:08 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210517120124/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname
2021-05-17 17:03:08 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/67cb8fce-da04-4400-9d59-3cb6a6865f4e.tmp'
2021-05-17 17:03:08 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] Opened sftp connection (server version 3)

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_prefer_fqdn Detected image: image_id=hirsute os=ubuntu release=hirsute

-------------------------------- live log setup --------------------------------
2021-05-17 17:03:12 INFO      integration_testing:clouds.py:88 Detected image: image_id=hirsute os=ubuntu release=hirsute
Launching instance with launch_kwargs:
image_id=local:grown-kodiak-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: True
hostname: cloudinit1
fqdn: cloudinit2.test.io

2021-05-17 17:03:12 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:grown-kodiak-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: True
hostname: cloudinit1
fqdn: cloudinit2.test.io

['lxc', 'init', 'local:grown-kodiak-snapshot', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nprefer_fqdn_over_hostname: True\nhostname: cloudinit1\nfqdn: cloudinit2.test.io\n']
2021-05-17 17:03:15 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-17 17:03:16 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.253.153.99
Retrying SSH connection to ubuntu@10.253.153.99:22 (598s left)
2021-05-17 17:03:17 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.4p1)
2021-05-17 17:03:17 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-17 17:03:17 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=handy-reptile)
2021-05-17 17:03:20 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=handy-reptile)
2021-05-17 17:03:20 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~21.04.1
2021-05-17 17:03:20 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~21.04.1
2021-05-17 17:03:20 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210513
2021-05-17 17:03:20 INFO      integration_testing:clouds.py:183 image serial: 20210513
-------------------------------- live log call ---------------------------------
2021-05-17 17:03:20 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
PASSED
------------------------------ live log teardown -------------------------------
2021-05-17 17:03:20 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210517120124/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_fqdn
2021-05-17 17:03:21 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210517120124/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_fqdn
2021-05-17 17:03:21 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/8709e89a-327a-4495-b7e8-672e0bb9a863.tmp'
2021-05-17 17:03:21 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] Opened sftp connection (server version 3)

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_prefer_short_hostname Detected image: image_id=hirsute os=ubuntu release=hirsute

-------------------------------- live log setup --------------------------------
2021-05-17 17:03:25 INFO      integration_testing:clouds.py:88 Detected image: image_id=hirsute os=ubuntu release=hirsute
Launching instance with launch_kwargs:
image_id=local:grown-kodiak-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: False
hostname: cloudinit1
fqdn: cloudinit2.test.io

2021-05-17 17:03:25 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:grown-kodiak-snapshot
user_data=#cloud-config
prefer_fqdn_over_hostname: False
hostname: cloudinit1
fqdn: cloudinit2.test.io

['lxc', 'init', 'local:grown-kodiak-snapshot', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nprefer_fqdn_over_hostname: False\nhostname: cloudinit1\nfqdn: cloudinit2.test.io\n']
2021-05-17 17:03:28 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-17 17:03:29 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.253.153.203
Retrying SSH connection to ubuntu@10.253.153.203:22 (598s left)
2021-05-17 17:03:30 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.4p1)
2021-05-17 17:03:30 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-17 17:03:31 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=bursting-imp)
2021-05-17 17:03:33 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=bursting-imp)
2021-05-17 17:03:33 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~21.04.1
2021-05-17 17:03:33 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~21.04.1
2021-05-17 17:03:33 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210513
2021-05-17 17:03:34 INFO      integration_testing:clouds.py:183 image serial: 20210513
-------------------------------- live log call ---------------------------------
2021-05-17 17:03:34 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
PASSED
------------------------------ live log teardown -------------------------------
2021-05-17 17:03:34 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210517120124/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_short_hostname
2021-05-17 17:03:34 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210517120124/tests/integration_tests/modules/test_set_hostname/TestHostname/test_prefer_short_hostname
2021-05-17 17:03:34 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/571cf2c0-6c2c-4909-80b5-5e1555bc7ba2.tmp'
2021-05-17 17:03:34 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] Opened sftp connection (server version 3)

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_hostname_and_fqdn Detected image: image_id=hirsute os=ubuntu release=hirsute

-------------------------------- live log setup --------------------------------
2021-05-17 17:03:39 INFO      integration_testing:clouds.py:88 Detected image: image_id=hirsute os=ubuntu release=hirsute
Launching instance with launch_kwargs:
image_id=local:grown-kodiak-snapshot
user_data=#cloud-config
manage_etc_hosts: true
hostname: cloudinit1
fqdn: cloudinit2.i9n.cloud-init.io

2021-05-17 17:03:39 INFO      integration_testing:clouds.py:168 Launching instance with launch_kwargs:
image_id=local:grown-kodiak-snapshot
user_data=#cloud-config
manage_etc_hosts: true
hostname: cloudinit1
fqdn: cloudinit2.i9n.cloud-init.io

2021-05-17 17:03:39 INFO      paramiko.transport.sftp:sftp.py:158 [chan 7] sftp session closed.
['lxc', 'init', 'local:grown-kodiak-snapshot', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nmanage_etc_hosts: true\nhostname: cloudinit1\nfqdn: cloudinit2.i9n.cloud-init.io\n']
2021-05-17 17:03:42 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-05-17 17:03:43 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.253.153.23
Retrying SSH connection to ubuntu@10.253.153.23:22 (598s left)
2021-05-17 17:03:44 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.253.153.23
Retrying SSH connection to ubuntu@10.253.153.23:22 (597s left)
2021-05-17 17:03:45 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.4p1)
2021-05-17 17:03:45 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-05-17 17:03:46 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=funny-pangolin)
2021-05-17 17:03:48 INFO      integration_testing:clouds.py:173 Launched instance: LXDInstance(name=funny-pangolin)
2021-05-17 17:03:48 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~21.04.1
2021-05-17 17:03:48 INFO      integration_testing:clouds.py:179 cloud-init version: /usr/bin/cloud-init 21.2-3-g899bfaa9-0ubuntu2~21.04.1
2021-05-17 17:03:48 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210513
2021-05-17 17:03:48 INFO      integration_testing:clouds.py:183 image serial: 20210513
-------------------------------- live log call ---------------------------------
2021-05-17 17:03:48 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c hostname
2021-05-17 17:03:48 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'hostname --fqdn'
2021-05-17 17:03:48 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep ^127 /etc/hosts'
PASSED
------------------------------ live log teardown -------------------------------
2021-05-17 17:03:48 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init collect-logs -u -t /var/tmp/cloud-init.tar.gz'
Writing logs to /tmp/cloud_init_test_logs/210517120124/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname_and_fqdn
2021-05-17 17:03:49 INFO      integration_testing:conftest.py:192 Writing logs to /tmp/cloud_init_test_logs/210517120124/tests/integration_tests/modules/test_set_hostname/TestHostname/test_hostname_and_fqdn
2021-05-17 17:03:49 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cp /var/tmp/cloud-init.tar.gz /var/tmp/e74b9741-9a7c-487d-9f7c-5b7bb78f68ca.tmp'
2021-05-17 17:03:49 INFO      paramiko.transport.sftp:sftp.py:158 [chan 9] Opened sftp connection (server version 3)
Deleting snapshot image created for this testrun: local:grown-kodiak-snapshot
2021-05-17 17:03:53 INFO      integration_testing:clouds.py:204 Deleting snapshot image created for this testrun: local:grown-kodiak-snapshot


=============================== warnings summary ===============================
../envs/cloud-init/lib/python3.5/site-packages/jwt/utils.py:8
  /home/james/envs/cloud-init/lib/python3.5/site-packages/jwt/utils.py:8: CryptographyDeprecationWarning: Python 3.5 support will be dropped in the next release of cryptography. Please upgrade your Python.
    from cryptography.hazmat.primitives.asymmetric.utils import (

tests/integration_tests/modules/test_set_hostname.py::TestHostname::test_hostname
  /home/james/envs/cloud-init/lib/python3.5/site-packages/simplestreams/mirrors/__init__.py:207: DeprecationWarning: The 'warn' method is deprecated, use 'warning' instead
    self.prefix, path)

-- Docs: https://docs.pytest.org/en/stable/warnings.html
================== 4 passed, 2 warnings in 148.88s (0:02:28) ===================


[Regression Potential]
A bug in implementation could cause hostname to be set incorrectly.
