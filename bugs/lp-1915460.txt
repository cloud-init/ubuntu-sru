https://github.com/canonical/cloud-init/commit/e384a5436560c9494118f0999c314982d4912d27

=== Begin SRU Template ===
[Impact]
This change adds an option to disable key emission to logs

[Test Case]
There is an upstream test for this bug:
https://github.com/canonical/cloud-init/blob/master/tests/integration_tests/modules/test_keys_to_console.py

=== Xenial ===
============================= test session starts ==============================
platform linux -- Python 3.5.9, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /home/james/cloud-init-tests, inifile: tox.ini
plugins: cov-2.9.0
collected 10 items

tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_excluded_keys[DSA] Detected image: image_id=xenial os=ubuntu release=xenial

-------------------------------- live log setup --------------------------------
2021-03-25 19:24:17 INFO      integration_testing:clouds.py:87 Detected image: image_id=xenial os=ubuntu release=xenial
Detected image: image_id=xenial os=ubuntu release=xenial
2021-03-25 19:24:17 INFO      integration_testing:clouds.py:87 Detected image: image_id=xenial os=ubuntu release=xenial
Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=xenial
PLATFORM=lxd_vm
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
2021-03-25 19:24:17 INFO      integration_testing:clouds.py:128 Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=xenial
PLATFORM=lxd_vm
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
Setting up environment for lxd_vm
2021-03-25 19:24:17 INFO      integration_testing:conftest.py:156 Setting up environment for lxd_vm
Launching instance with launch_kwargs:
image_id=images:ubuntu/16.04/cloud
user_data=None
2021-03-25 19:24:17 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
image_id=images:ubuntu/16.04/cloud
user_data=None
The profile named pycloudlib-vm-xenial-v1 already exists
['lxc', 'init', 'images:ubuntu/16.04/cloud', '--profile', 'pycloudlib-vm-xenial-v1', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--vm']
2021-03-25 19:27:11 INFO      pycloudlib.instance:instance.py:161 executing: sh -c whoami
2021-03-25 19:27:28 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (583s left)
2021-03-25 19:27:29 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (582s left)
2021-03-25 19:27:30 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (581s left)
2021-03-25 19:27:31 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (579s left)
2021-03-25 19:27:33 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (578s left)
2021-03-25 19:27:34 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (577s left)
2021-03-25 19:27:35 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (575s left)
2021-03-25 19:27:37 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (574s left)
2021-03-25 19:27:38 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (572s left)
2021-03-25 19:27:40 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (571s left)
2021-03-25 19:27:41 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (570s left)
2021-03-25 19:27:43 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (568s left)
2021-03-25 19:27:44 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (567s left)
2021-03-25 19:27:45 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (566s left)
2021-03-25 19:27:47 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (564s left)
2021-03-25 19:27:48 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (563s left)
2021-03-25 19:27:49 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (561s left)
2021-03-25 19:27:51 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (560s left)
2021-03-25 19:27:52 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (559s left)
2021-03-25 19:27:53 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.2p2)
2021-03-25 19:27:53 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-25 19:27:54 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'cloud-init status --help'
2021-03-25 19:27:54 INFO      pycloudlib.instance:instance.py:161 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=guiding-glowworm)
2021-03-25 19:27:54 INFO      integration_testing:clouds.py:171 Launched instance: LXDInstance(name=guiding-glowworm)
2021-03-25 19:27:54 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 20.4.1-0ubuntu1~16.04.1
2021-03-25 19:27:54 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 20.4.1-0ubuntu1~16.04.1
2021-03-25 19:27:54 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
Installing proposed image
2021-03-25 19:27:54 INFO      integration_testing:instances.py:144 Installing proposed image
2021-03-25 19:27:54 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'echo deb "http://archive.ubuntu.com/ubuntu $(lsb_release -sc)-proposed main" | tee /etc/apt/sources.list.d/proposed.list
apt-get update -q
apt-get install -qy cloud-init'
2021-03-25 19:28:02 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cloud-init -v'
Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~16.04.1
2021-03-25 19:28:02 INFO      integration_testing:instances.py:136 Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~16.04.1
2021-03-25 19:28:02 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-25 19:28:03 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-03-25 19:28:03 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-25 19:28:03 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-03-25 19:28:03 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-25 19:28:03 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'sudo rm -rf /var/log/syslog'
Created new image: local:guiding-glowworm-snapshot
2021-03-25 19:28:55 INFO      integration_testing:instances.py:113 Created new image: local:guiding-glowworm-snapshot
Done with environment setup
2021-03-25 19:28:55 INFO      integration_testing:conftest.py:162 Done with environment setup
Launching instance with launch_kwargs:
image_id=local:guiding-glowworm-snapshot
user_data=#cloud-config
ssh_fp_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]
ssh_key_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]

2021-03-25 19:28:55 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
image_id=local:guiding-glowworm-snapshot
user_data=#cloud-config
ssh_fp_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]
ssh_key_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]

['lxc', 'init', 'local:guiding-glowworm-snapshot', '--profile', 'pycloudlib-vm-xenial-v1', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nssh_fp_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]\nssh_key_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]\n', '--vm']
2021-03-25 19:29:50 INFO      pycloudlib.instance:instance.py:161 executing: sh -c whoami
2021-03-25 19:30:07 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (583s left)
2021-03-25 19:30:08 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (582s left)
2021-03-25 19:30:09 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (581s left)
2021-03-25 19:30:10 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (580s left)
2021-03-25 19:30:11 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.2p2)
2021-03-25 19:30:12 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-25 19:30:12 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'cloud-init status --help'
2021-03-25 19:30:12 INFO      pycloudlib.instance:instance.py:161 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=star-colt)
2021-03-25 19:30:15 INFO      integration_testing:clouds.py:171 Launched instance: LXDInstance(name=star-colt)
2021-03-25 19:30:15 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~16.04.1
2021-03-25 19:30:16 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~16.04.1
2021-03-25 19:30:16 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
-------------------------------- live log call ---------------------------------
2021-03-25 19:30:16 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_excluded_keys[ECDSA] Detected image: image_id=xenial os=ubuntu release=xenial

-------------------------------- live log setup --------------------------------
2021-03-25 19:30:16 INFO      integration_testing:clouds.py:87 Detected image: image_id=xenial os=ubuntu release=xenial
-------------------------------- live log call ---------------------------------
2021-03-25 19:30:16 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_included_keys[ED25519] Detected image: image_id=xenial os=ubuntu release=xenial

-------------------------------- live log setup --------------------------------
2021-03-25 19:30:16 INFO      integration_testing:clouds.py:87 Detected image: image_id=xenial os=ubuntu release=xenial
-------------------------------- live log call ---------------------------------
2021-03-25 19:30:16 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_included_keys[RSA] Detected image: image_id=xenial os=ubuntu release=xenial

-------------------------------- live log setup --------------------------------
2021-03-25 19:30:16 INFO      integration_testing:clouds.py:87 Detected image: image_id=xenial os=ubuntu release=xenial
-------------------------------- live log call ---------------------------------
2021-03-25 19:30:16 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[DSA] Detected image: image_id=xenial os=ubuntu release=xenial

-------------------------------- live log setup --------------------------------
2021-03-25 19:30:16 INFO      integration_testing:clouds.py:87 Detected image: image_id=xenial os=ubuntu release=xenial
Launching instance with launch_kwargs:
image_id=local:guiding-glowworm-snapshot
user_data=#cloud-config
ssh:
  emit_keys_to_console: false

2021-03-25 19:30:16 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
image_id=local:guiding-glowworm-snapshot
user_data=#cloud-config
ssh:
  emit_keys_to_console: false

['lxc', 'init', 'local:guiding-glowworm-snapshot', '--profile', 'pycloudlib-vm-xenial-v1', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nssh:\n  emit_keys_to_console: false\n', '--vm']
2021-03-25 19:30:17 INFO      pycloudlib.instance:instance.py:161 executing: sh -c whoami
2021-03-25 19:30:33 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (583s left)
2021-03-25 19:30:34 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (582s left)
2021-03-25 19:30:36 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (581s left)
2021-03-25 19:30:37 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.237
Retrying SSH connection to ubuntu@10.37.179.237:22 (580s left)
2021-03-25 19:30:38 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.2p2)
2021-03-25 19:30:38 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-25 19:30:39 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'cloud-init status --help'
2021-03-25 19:30:39 INFO      pycloudlib.instance:instance.py:161 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=joint-koala)
2021-03-25 19:30:42 INFO      integration_testing:clouds.py:171 Launched instance: LXDInstance(name=joint-koala)
2021-03-25 19:30:42 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~16.04.1
2021-03-25 19:30:42 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~16.04.1
2021-03-25 19:30:42 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
-------------------------------- live log call ---------------------------------
2021-03-25 19:30:42 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[ECDSA] Detected image: image_id=xenial os=ubuntu release=xenial

-------------------------------- live log setup --------------------------------
2021-03-25 19:30:42 INFO      integration_testing:clouds.py:87 Detected image: image_id=xenial os=ubuntu release=xenial
-------------------------------- live log call ---------------------------------
2021-03-25 19:30:42 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[ED25519] Detected image: image_id=xenial os=ubuntu release=xenial

-------------------------------- live log setup --------------------------------
2021-03-25 19:30:43 INFO      integration_testing:clouds.py:87 Detected image: image_id=xenial os=ubuntu release=xenial
-------------------------------- live log call ---------------------------------
2021-03-25 19:30:43 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[RSA] Detected image: image_id=xenial os=ubuntu release=xenial

-------------------------------- live log setup --------------------------------
2021-03-25 19:30:43 INFO      integration_testing:clouds.py:87 Detected image: image_id=xenial os=ubuntu release=xenial
-------------------------------- live log call ---------------------------------
2021-03-25 19:30:43 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_header_excluded Detected image: image_id=xenial os=ubuntu release=xenial

-------------------------------- live log setup --------------------------------
2021-03-25 19:30:43 INFO      integration_testing:clouds.py:87 Detected image: image_id=xenial os=ubuntu release=xenial
-------------------------------- live log call ---------------------------------
2021-03-25 19:30:43 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_footer_excluded Detected image: image_id=xenial os=ubuntu release=xenial

-------------------------------- live log setup --------------------------------
2021-03-25 19:30:43 INFO      integration_testing:clouds.py:87 Detected image: image_id=xenial os=ubuntu release=xenial
-------------------------------- live log call ---------------------------------
2021-03-25 19:30:43 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSEDDeleting snapshot image created for this testrun: local:guiding-glowworm-snapshot

------------------------------ live log teardown -------------------------------
2021-03-25 19:30:43 INFO      integration_testing:clouds.py:202 Deleting snapshot image created for this testrun: local:guiding-glowworm-snapshot


======================== 10 passed in 386.36s (0:06:26) ========================


=== Bionic ===
============================= test session starts ==============================
platform linux -- Python 3.5.9, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /home/james/cloud-init-tests, inifile: tox.ini
plugins: cov-2.9.0
collected 10 items

tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_excluded_keys[DSA] Detected image: image_id=bionic os=ubuntu release=bionic

-------------------------------- live log setup --------------------------------
2021-03-25 19:39:50 INFO      integration_testing:clouds.py:87 Detected image: image_id=bionic os=ubuntu release=bionic
Detected image: image_id=bionic os=ubuntu release=bionic
2021-03-25 19:39:50 INFO      integration_testing:clouds.py:87 Detected image: image_id=bionic os=ubuntu release=bionic
Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=bionic
PLATFORM=lxd_vm
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
2021-03-25 19:40:03 INFO      integration_testing:clouds.py:128 Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=bionic
PLATFORM=lxd_vm
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
Setting up environment for lxd_vm
2021-03-25 19:40:03 INFO      integration_testing:conftest.py:156 Setting up environment for lxd_vm
Launching instance with launch_kwargs:
user_data=None
image_id=ubuntu:fa43cc40052fdeca5f21412e037187c06931f70dc5f46d19bf184ea741a87624
2021-03-25 19:40:03 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
user_data=None
image_id=ubuntu:fa43cc40052fdeca5f21412e037187c06931f70dc5f46d19bf184ea741a87624
['lxc', 'init', 'ubuntu:fa43cc40052fdeca5f21412e037187c06931f70dc5f46d19bf184ea741a87624', '--profile', 'pycloudlib-vm-bionic-v1', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--vm']
2021-03-25 19:44:47 INFO      pycloudlib.instance:instance.py:161 executing: sh -c whoami
2021-03-25 19:45:11 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.6
Retrying SSH connection to ubuntu@10.37.179.6:22 (576s left)
2021-03-25 19:45:12 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.6
Retrying SSH connection to ubuntu@10.37.179.6:22 (574s left)
2021-03-25 19:45:13 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.6
Retrying SSH connection to ubuntu@10.37.179.6:22 (573s left)
2021-03-25 19:45:14 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.6
Retrying SSH connection to ubuntu@10.37.179.6:22 (572s left)
2021-03-25 19:45:15 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.6p1)
2021-03-25 19:45:15 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-25 19:45:16 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'cloud-init status --help'
2021-03-25 19:45:17 INFO      pycloudlib.instance:instance.py:161 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=precious-glider)
2021-03-25 19:45:33 INFO      integration_testing:clouds.py:171 Launched instance: LXDInstance(name=precious-glider)
2021-03-25 19:45:33 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cloud-init --version'
2021-03-25 19:45:33 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.6p1)
2021-03-25 19:45:34 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-25 19:45:34 ERROR     paramiko.transport:transport.py:1819 Socket exception: Connection reset by peer (104)
2021-03-25 19:45:35 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.6
Retrying SSH connection to ubuntu@10.37.179.6:22 (598s left)
2021-03-25 19:46:08 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.6p1)
2021-03-25 19:46:08 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
cloud-init version: /usr/bin/cloud-init 20.4.1-0ubuntu1~18.04.1
2021-03-25 19:46:09 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 20.4.1-0ubuntu1~18.04.1
2021-03-25 19:46:09 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210319
2021-03-25 19:46:09 INFO      integration_testing:clouds.py:181 image serial: 20210319
Installing proposed image
2021-03-25 19:46:09 INFO      integration_testing:instances.py:144 Installing proposed image
2021-03-25 19:46:09 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'echo deb "http://archive.ubuntu.com/ubuntu $(lsb_release -sc)-proposed main" | tee /etc/apt/sources.list.d/proposed.list
apt-get update -q
apt-get install -qy cloud-init'
2021-03-25 19:46:34 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cloud-init -v'
Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~18.04.1
2021-03-25 19:46:34 INFO      integration_testing:instances.py:136 Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~18.04.1
2021-03-25 19:46:34 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-25 19:46:34 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-03-25 19:46:34 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-25 19:46:35 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-03-25 19:46:35 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-25 19:46:35 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'sudo rm -rf /var/log/syslog'
Created new image: local:precious-glider-snapshot
2021-03-25 19:47:56 INFO      integration_testing:instances.py:113 Created new image: local:precious-glider-snapshot
Done with environment setup
2021-03-25 19:47:56 INFO      integration_testing:conftest.py:162 Done with environment setup
Launching instance with launch_kwargs:
user_data=#cloud-config
ssh_fp_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]
ssh_key_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]

image_id=local:precious-glider-snapshot
2021-03-25 19:47:56 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
user_data=#cloud-config
ssh_fp_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]
ssh_key_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]

image_id=local:precious-glider-snapshot
['lxc', 'init', 'local:precious-glider-snapshot', '--profile', 'pycloudlib-vm-bionic-v1', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nssh_fp_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]\nssh_key_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]\n', '--vm']
2021-03-25 19:49:01 INFO      pycloudlib.instance:instance.py:161 executing: sh -c whoami
2021-03-25 19:49:49 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.81
Retrying SSH connection to ubuntu@10.37.179.81:22 (551s left)
2021-03-25 19:49:51 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.6p1)
2021-03-25 19:49:51 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-25 19:49:52 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'cloud-init status --help'
2021-03-25 19:49:52 INFO      pycloudlib.instance:instance.py:161 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=patient-sole)
2021-03-25 19:49:56 INFO      integration_testing:clouds.py:171 Launched instance: LXDInstance(name=patient-sole)
2021-03-25 19:49:56 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~18.04.1
2021-03-25 19:49:56 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~18.04.1
2021-03-25 19:49:56 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210319
2021-03-25 19:49:56 INFO      integration_testing:clouds.py:181 image serial: 20210319
-------------------------------- live log call ---------------------------------
2021-03-25 19:49:56 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_excluded_keys[ECDSA] Detected image: image_id=bionic os=ubuntu release=bionic

-------------------------------- live log setup --------------------------------
2021-03-25 19:49:57 INFO      integration_testing:clouds.py:87 Detected image: image_id=bionic os=ubuntu release=bionic
-------------------------------- live log call ---------------------------------
2021-03-25 19:49:57 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_included_keys[ED25519] Detected image: image_id=bionic os=ubuntu release=bionic

-------------------------------- live log setup --------------------------------
2021-03-25 19:49:57 INFO      integration_testing:clouds.py:87 Detected image: image_id=bionic os=ubuntu release=bionic
-------------------------------- live log call ---------------------------------
2021-03-25 19:49:57 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_included_keys[RSA] Detected image: image_id=bionic os=ubuntu release=bionic

-------------------------------- live log setup --------------------------------
2021-03-25 19:49:57 INFO      integration_testing:clouds.py:87 Detected image: image_id=bionic os=ubuntu release=bionic
-------------------------------- live log call ---------------------------------
2021-03-25 19:49:57 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[DSA] Detected image: image_id=bionic os=ubuntu release=bionic

-------------------------------- live log setup --------------------------------
2021-03-25 19:49:57 INFO      integration_testing:clouds.py:87 Detected image: image_id=bionic os=ubuntu release=bionic
Launching instance with launch_kwargs:
user_data=#cloud-config
ssh:
  emit_keys_to_console: false

image_id=local:precious-glider-snapshot
2021-03-25 19:49:57 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
user_data=#cloud-config
ssh:
  emit_keys_to_console: false

image_id=local:precious-glider-snapshot
['lxc', 'init', 'local:precious-glider-snapshot', '--profile', 'pycloudlib-vm-bionic-v1', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nssh:\n  emit_keys_to_console: false\n', '--vm']
2021-03-25 19:49:58 INFO      pycloudlib.instance:instance.py:161 executing: sh -c whoami
2021-03-25 19:50:46 INFO      pycloudlib.instance:instance.py:338 [Errno None] Unable to connect to port 22 on 10.37.179.103
Retrying SSH connection to ubuntu@10.37.179.103:22 (551s left)
2021-03-25 19:50:47 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_7.6p1)
2021-03-25 19:50:47 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-25 19:50:48 INFO      pycloudlib.instance:instance.py:161 executing: sh -c 'cloud-init status --help'
2021-03-25 19:50:49 INFO      pycloudlib.instance:instance.py:161 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=teaching-man)
2021-03-25 19:50:53 INFO      integration_testing:clouds.py:171 Launched instance: LXDInstance(name=teaching-man)
2021-03-25 19:50:53 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~18.04.1
2021-03-25 19:50:53 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~18.04.1
2021-03-25 19:50:53 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210319
2021-03-25 19:50:53 INFO      integration_testing:clouds.py:181 image serial: 20210319
-------------------------------- live log call ---------------------------------
2021-03-25 19:50:53 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[ECDSA] Detected image: image_id=bionic os=ubuntu release=bionic

-------------------------------- live log setup --------------------------------
2021-03-25 19:50:53 INFO      integration_testing:clouds.py:87 Detected image: image_id=bionic os=ubuntu release=bionic
-------------------------------- live log call ---------------------------------
2021-03-25 19:50:53 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[ED25519] Detected image: image_id=bionic os=ubuntu release=bionic

-------------------------------- live log setup --------------------------------
2021-03-25 19:50:53 INFO      integration_testing:clouds.py:87 Detected image: image_id=bionic os=ubuntu release=bionic
-------------------------------- live log call ---------------------------------
2021-03-25 19:50:53 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[RSA] Detected image: image_id=bionic os=ubuntu release=bionic

-------------------------------- live log setup --------------------------------
2021-03-25 19:50:53 INFO      integration_testing:clouds.py:87 Detected image: image_id=bionic os=ubuntu release=bionic
-------------------------------- live log call ---------------------------------
2021-03-25 19:50:53 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_header_excluded Detected image: image_id=bionic os=ubuntu release=bionic

-------------------------------- live log setup --------------------------------
2021-03-25 19:50:53 INFO      integration_testing:clouds.py:87 Detected image: image_id=bionic os=ubuntu release=bionic
-------------------------------- live log call ---------------------------------
2021-03-25 19:50:53 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_footer_excluded Detected image: image_id=bionic os=ubuntu release=bionic

-------------------------------- live log setup --------------------------------
2021-03-25 19:50:53 INFO      integration_testing:clouds.py:87 Detected image: image_id=bionic os=ubuntu release=bionic
-------------------------------- live log call ---------------------------------
2021-03-25 19:50:53 INFO      pycloudlib.instance:instance.py:161 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSEDDeleting snapshot image created for this testrun: local:precious-glider-snapshot

------------------------------ live log teardown -------------------------------
2021-03-25 19:50:54 INFO      integration_testing:clouds.py:202 Deleting snapshot image created for this testrun: local:precious-glider-snapshot


======================== 10 passed in 664.12s (0:11:04) ========================


=== Focal ===
============================= test session starts ==============================
platform linux -- Python 3.5.9, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /home/james/cloud-init-tests, inifile: tox.ini
plugins: cov-2.9.0
collected 10 items

tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_excluded_keys[DSA] Detected image: image_id=focal os=ubuntu release=focal

-------------------------------- live log setup --------------------------------
2021-03-25 20:07:14 INFO      integration_testing:clouds.py:87 Detected image: image_id=focal os=ubuntu release=focal
Detected image: image_id=focal os=ubuntu release=focal
2021-03-25 20:07:14 INFO      integration_testing:clouds.py:87 Detected image: image_id=focal os=ubuntu release=focal
Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=focal
PLATFORM=lxd_vm
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
2021-03-25 20:07:27 INFO      integration_testing:clouds.py:128 Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=focal
PLATFORM=lxd_vm
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
Setting up environment for lxd_vm
2021-03-25 20:07:27 INFO      integration_testing:conftest.py:156 Setting up environment for lxd_vm
Launching instance with launch_kwargs:
image_id=ubuntu:a56b7ffd973b320cc408f47b6e4017b4e7a8d35df4b53e30096faf00870834dd
user_data=None
2021-03-25 20:07:27 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
image_id=ubuntu:a56b7ffd973b320cc408f47b6e4017b4e7a8d35df4b53e30096faf00870834dd
user_data=None
['lxc', 'init', 'ubuntu:a56b7ffd973b320cc408f47b6e4017b4e7a8d35df4b53e30096faf00870834dd', '--profile', 'pycloudlib-vm-focal-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--vm']
2021-03-25 20:14:27 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-03-25 20:14:48 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.110
Retrying SSH connection to ubuntu@10.37.179.110:22 (578s left)
2021-03-25 20:14:50 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.110
Retrying SSH connection to ubuntu@10.37.179.110:22 (577s left)
2021-03-25 20:14:51 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.110
Retrying SSH connection to ubuntu@10.37.179.110:22 (575s left)
2021-03-25 20:14:53 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.110
Retrying SSH connection to ubuntu@10.37.179.110:22 (574s left)
2021-03-25 20:14:54 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.110
Retrying SSH connection to ubuntu@10.37.179.110:22 (572s left)
2021-03-25 20:14:56 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.110
Retrying SSH connection to ubuntu@10.37.179.110:22 (571s left)
2021-03-25 20:14:57 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.2p1)
2021-03-25 20:14:57 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-25 20:14:58 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cloud-init status --help'
2021-03-25 20:14:58 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=eager-deer)
2021-03-25 20:15:01 INFO      integration_testing:clouds.py:171 Launched instance: LXDInstance(name=eager-deer)
2021-03-25 20:15:01 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 20.4.1-0ubuntu1~20.04.1
2021-03-25 20:15:02 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 20.4.1-0ubuntu1~20.04.1
2021-03-25 20:15:02 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210323
2021-03-25 20:15:02 INFO      integration_testing:clouds.py:181 image serial: 20210323
Installing proposed image
2021-03-25 20:15:02 INFO      integration_testing:instances.py:144 Installing proposed image
2021-03-25 20:15:02 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'echo deb "http://archive.ubuntu.com/ubuntu $(lsb_release -sc)-proposed main" | tee /etc/apt/sources.list.d/proposed.list
apt-get update -q
apt-get install -qy cloud-init'
2021-03-25 20:15:26 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init -v'
Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~20.04.1
2021-03-25 20:15:26 INFO      integration_testing:instances.py:136 Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~20.04.1
2021-03-25 20:15:26 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-25 20:15:26 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-03-25 20:15:26 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-25 20:15:26 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-03-25 20:15:26 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-25 20:15:27 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
Created new image: local:eager-deer-snapshot
2021-03-25 20:17:01 INFO      integration_testing:instances.py:113 Created new image: local:eager-deer-snapshot
Done with environment setup
2021-03-25 20:17:01 INFO      integration_testing:conftest.py:162 Done with environment setup
Launching instance with launch_kwargs:
image_id=local:eager-deer-snapshot
user_data=#cloud-config
ssh_fp_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]
ssh_key_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]

2021-03-25 20:17:01 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
image_id=local:eager-deer-snapshot
user_data=#cloud-config
ssh_fp_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]
ssh_key_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]

['lxc', 'init', 'local:eager-deer-snapshot', '--profile', 'pycloudlib-vm-focal-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nssh_fp_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]\nssh_key_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]\n', '--vm']
2021-03-25 20:18:03 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-03-25 20:18:22 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.247
Retrying SSH connection to ubuntu@10.37.179.247:22 (581s left)
2021-03-25 20:18:23 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.247
Retrying SSH connection to ubuntu@10.37.179.247:22 (579s left)
2021-03-25 20:18:25 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.2p1)
2021-03-25 20:18:25 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-25 20:18:26 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cloud-init status --help'
2021-03-25 20:18:27 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=ace-falcon)
2021-03-25 20:18:30 INFO      integration_testing:clouds.py:171 Launched instance: LXDInstance(name=ace-falcon)
2021-03-25 20:18:30 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~20.04.1
2021-03-25 20:18:30 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~20.04.1
2021-03-25 20:18:30 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210323
2021-03-25 20:18:30 INFO      integration_testing:clouds.py:181 image serial: 20210323
-------------------------------- live log call ---------------------------------
2021-03-25 20:18:30 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_excluded_keys[ECDSA] Detected image: image_id=focal os=ubuntu release=focal

-------------------------------- live log setup --------------------------------
2021-03-25 20:18:30 INFO      integration_testing:clouds.py:87 Detected image: image_id=focal os=ubuntu release=focal
-------------------------------- live log call ---------------------------------
2021-03-25 20:18:30 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_included_keys[ED25519] Detected image: image_id=focal os=ubuntu release=focal

-------------------------------- live log setup --------------------------------
2021-03-25 20:18:30 INFO      integration_testing:clouds.py:87 Detected image: image_id=focal os=ubuntu release=focal
-------------------------------- live log call ---------------------------------
2021-03-25 20:18:30 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_included_keys[RSA] Detected image: image_id=focal os=ubuntu release=focal

-------------------------------- live log setup --------------------------------
2021-03-25 20:18:30 INFO      integration_testing:clouds.py:87 Detected image: image_id=focal os=ubuntu release=focal
-------------------------------- live log call ---------------------------------
2021-03-25 20:18:30 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[DSA] Detected image: image_id=focal os=ubuntu release=focal

-------------------------------- live log setup --------------------------------
2021-03-25 20:18:30 INFO      integration_testing:clouds.py:87 Detected image: image_id=focal os=ubuntu release=focal
Launching instance with launch_kwargs:
image_id=local:eager-deer-snapshot
user_data=#cloud-config
ssh:
  emit_keys_to_console: false

2021-03-25 20:18:30 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
image_id=local:eager-deer-snapshot
user_data=#cloud-config
ssh:
  emit_keys_to_console: false

['lxc', 'init', 'local:eager-deer-snapshot', '--profile', 'pycloudlib-vm-focal-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nssh:\n  emit_keys_to_console: false\n', '--vm']
2021-03-25 20:18:31 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-03-25 20:18:50 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.105
Retrying SSH connection to ubuntu@10.37.179.105:22 (581s left)
2021-03-25 20:18:51 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.105
Retrying SSH connection to ubuntu@10.37.179.105:22 (579s left)
2021-03-25 20:18:53 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.2p1)
2021-03-25 20:18:53 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-25 20:18:54 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cloud-init status --help'
2021-03-25 20:18:55 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=enhanced-woodcock)
2021-03-25 20:18:58 INFO      integration_testing:clouds.py:171 Launched instance: LXDInstance(name=enhanced-woodcock)
2021-03-25 20:18:58 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~20.04.1
2021-03-25 20:18:58 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~20.04.1
2021-03-25 20:18:58 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210323
2021-03-25 20:18:58 INFO      integration_testing:clouds.py:181 image serial: 20210323
-------------------------------- live log call ---------------------------------
2021-03-25 20:18:58 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[ECDSA] Detected image: image_id=focal os=ubuntu release=focal

-------------------------------- live log setup --------------------------------
2021-03-25 20:18:58 INFO      integration_testing:clouds.py:87 Detected image: image_id=focal os=ubuntu release=focal
-------------------------------- live log call ---------------------------------
2021-03-25 20:18:58 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[ED25519] Detected image: image_id=focal os=ubuntu release=focal

-------------------------------- live log setup --------------------------------
2021-03-25 20:18:58 INFO      integration_testing:clouds.py:87 Detected image: image_id=focal os=ubuntu release=focal
-------------------------------- live log call ---------------------------------
2021-03-25 20:18:58 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[RSA] Detected image: image_id=focal os=ubuntu release=focal

-------------------------------- live log setup --------------------------------
2021-03-25 20:18:58 INFO      integration_testing:clouds.py:87 Detected image: image_id=focal os=ubuntu release=focal
-------------------------------- live log call ---------------------------------
2021-03-25 20:18:58 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_header_excluded Detected image: image_id=focal os=ubuntu release=focal

-------------------------------- live log setup --------------------------------
2021-03-25 20:18:58 INFO      integration_testing:clouds.py:87 Detected image: image_id=focal os=ubuntu release=focal
-------------------------------- live log call ---------------------------------
2021-03-25 20:18:58 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_footer_excluded Detected image: image_id=focal os=ubuntu release=focal

-------------------------------- live log setup --------------------------------
2021-03-25 20:18:58 INFO      integration_testing:clouds.py:87 Detected image: image_id=focal os=ubuntu release=focal
-------------------------------- live log call ---------------------------------
2021-03-25 20:18:58 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSEDDeleting snapshot image created for this testrun: local:eager-deer-snapshot

------------------------------ live log teardown -------------------------------
2021-03-25 20:18:59 INFO      integration_testing:clouds.py:202 Deleting snapshot image created for this testrun: local:eager-deer-snapshot


======================== 10 passed in 705.22s (0:11:45) ========================


=== Groovy ===
============================= test session starts ==============================
platform linux -- Python 3.5.9, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /home/james/cloud-init-tests, inifile: tox.ini
plugins: cov-2.9.0
collected 10 items

tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_excluded_keys[DSA] Detected image: image_id=groovy os=ubuntu release=groovy

-------------------------------- live log setup --------------------------------
2021-03-25 20:32:20 INFO      integration_testing:clouds.py:87 Detected image: image_id=groovy os=ubuntu release=groovy
Detected image: image_id=groovy os=ubuntu release=groovy
2021-03-25 20:32:20 INFO      integration_testing:clouds.py:87 Detected image: image_id=groovy os=ubuntu release=groovy
Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=groovy
PLATFORM=lxd_vm
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
2021-03-25 20:32:33 INFO      integration_testing:clouds.py:128 Settings:
CLOUD_INIT_SOURCE=PROPOSED
COLLECT_LOGS=NEVER
EXISTING_INSTANCE_ID=None
INSTANCE_TYPE=None
KEEP_IMAGE=False
KEEP_INSTANCE=False
KEYPAIR_NAME=None
LOCAL_LOG_PATH=/tmp/cloud_init_test_logs
OPENSTACK_NETWORK=falcojr_admin_net
OS_IMAGE=groovy
PLATFORM=lxd_vm
PUBLIC_SSH_KEY=None
RUN_UNSTABLE=False
Setting up environment for lxd_vm
2021-03-25 20:32:33 INFO      integration_testing:conftest.py:156 Setting up environment for lxd_vm
Launching instance with launch_kwargs:
image_id=ubuntu:08c31b98a026f237c3d991c70acf7fc64bbc9b4e4ecaca2b8083f11eddef48ec
user_data=None
2021-03-25 20:32:33 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
image_id=ubuntu:08c31b98a026f237c3d991c70acf7fc64bbc9b4e4ecaca2b8083f11eddef48ec
user_data=None
['lxc', 'init', 'ubuntu:08c31b98a026f237c3d991c70acf7fc64bbc9b4e4ecaca2b8083f11eddef48ec', '--profile', 'pycloudlib-vm-groovy-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--vm']
2021-03-25 20:39:49 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-03-25 20:40:11 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.10
Retrying SSH connection to ubuntu@10.37.179.10:22 (577s left)
2021-03-25 20:40:13 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.10
Retrying SSH connection to ubuntu@10.37.179.10:22 (576s left)
2021-03-25 20:40:14 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.10
Retrying SSH connection to ubuntu@10.37.179.10:22 (574s left)
2021-03-25 20:40:16 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.10
Retrying SSH connection to ubuntu@10.37.179.10:22 (573s left)
2021-03-25 20:40:17 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.10
Retrying SSH connection to ubuntu@10.37.179.10:22 (571s left)
2021-03-25 20:40:19 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.10
Retrying SSH connection to ubuntu@10.37.179.10:22 (570s left)
2021-03-25 20:40:20 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.10
Retrying SSH connection to ubuntu@10.37.179.10:22 (568s left)
2021-03-25 20:40:21 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.10
Retrying SSH connection to ubuntu@10.37.179.10:22 (567s left)
2021-03-25 20:40:23 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.10
Retrying SSH connection to ubuntu@10.37.179.10:22 (565s left)
2021-03-25 20:40:24 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.3p1)
2021-03-25 20:40:24 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-25 20:40:25 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cloud-init status --help'
2021-03-25 20:40:25 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=square-rabbit)
2021-03-25 20:40:26 INFO      integration_testing:clouds.py:171 Launched instance: LXDInstance(name=square-rabbit)
2021-03-25 20:40:26 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 20.4.1-0ubuntu1~20.10.1
2021-03-25 20:40:26 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 20.4.1-0ubuntu1~20.10.1
2021-03-25 20:40:26 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210323
2021-03-25 20:40:26 INFO      integration_testing:clouds.py:181 image serial: 20210323
Installing proposed image
2021-03-25 20:40:26 INFO      integration_testing:instances.py:144 Installing proposed image
2021-03-25 20:40:26 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'echo deb "http://archive.ubuntu.com/ubuntu $(lsb_release -sc)-proposed main" | tee /etc/apt/sources.list.d/proposed.list
apt-get update -q
apt-get install -qy cloud-init'
2021-03-25 20:40:52 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init -v'
Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~20.10.1
2021-03-25 20:40:52 INFO      integration_testing:instances.py:136 Installed cloud-init version: 21.1-19-gbad84ad4-0ubuntu1~20.10.1
2021-03-25 20:40:52 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-25 20:40:53 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-03-25 20:40:53 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-25 20:40:53 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
2021-03-25 20:40:53 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo cloud-init clean --logs'
2021-03-25 20:40:53 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'sudo rm -rf /var/log/syslog'
Created new image: local:square-rabbit-snapshot
2021-03-25 20:42:23 INFO      integration_testing:instances.py:113 Created new image: local:square-rabbit-snapshot
Done with environment setup
2021-03-25 20:42:23 INFO      integration_testing:conftest.py:162 Done with environment setup
Launching instance with launch_kwargs:
image_id=local:square-rabbit-snapshot
user_data=#cloud-config
ssh_fp_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]
ssh_key_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]

2021-03-25 20:42:23 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
image_id=local:square-rabbit-snapshot
user_data=#cloud-config
ssh_fp_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]
ssh_key_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]

['lxc', 'init', 'local:square-rabbit-snapshot', '--profile', 'pycloudlib-vm-groovy-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nssh_fp_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]\nssh_key_console_blacklist: [ssh-dss, ssh-dsa, ecdsa-sha2-nistp256]\n', '--vm']
2021-03-25 20:43:42 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-03-25 20:44:02 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.180
Retrying SSH connection to ubuntu@10.37.179.180:22 (579s left)
2021-03-25 20:44:03 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.180
Retrying SSH connection to ubuntu@10.37.179.180:22 (578s left)
2021-03-25 20:44:05 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.180
Retrying SSH connection to ubuntu@10.37.179.180:22 (576s left)
2021-03-25 20:44:07 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.180
Retrying SSH connection to ubuntu@10.37.179.180:22 (575s left)
2021-03-25 20:44:08 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.180
Retrying SSH connection to ubuntu@10.37.179.180:22 (573s left)
2021-03-25 20:44:10 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.180
Retrying SSH connection to ubuntu@10.37.179.180:22 (572s left)
2021-03-25 20:44:11 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.180
Retrying SSH connection to ubuntu@10.37.179.180:22 (570s left)
2021-03-25 20:44:12 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.180
Retrying SSH connection to ubuntu@10.37.179.180:22 (569s left)
2021-03-25 20:44:14 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.3p1)
2021-03-25 20:44:14 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-25 20:44:14 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cloud-init status --help'
2021-03-25 20:44:14 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=daring-dassie)
2021-03-25 20:44:15 INFO      integration_testing:clouds.py:171 Launched instance: LXDInstance(name=daring-dassie)
2021-03-25 20:44:15 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~20.10.1
2021-03-25 20:44:15 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~20.10.1
2021-03-25 20:44:15 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210323
2021-03-25 20:44:15 INFO      integration_testing:clouds.py:181 image serial: 20210323
-------------------------------- live log call ---------------------------------
2021-03-25 20:44:15 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_excluded_keys[ECDSA] Detected image: image_id=groovy os=ubuntu release=groovy

-------------------------------- live log setup --------------------------------
2021-03-25 20:44:15 INFO      integration_testing:clouds.py:87 Detected image: image_id=groovy os=ubuntu release=groovy
-------------------------------- live log call ---------------------------------
2021-03-25 20:44:15 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_included_keys[ED25519] Detected image: image_id=groovy os=ubuntu release=groovy

-------------------------------- live log setup --------------------------------
2021-03-25 20:44:15 INFO      integration_testing:clouds.py:87 Detected image: image_id=groovy os=ubuntu release=groovy
-------------------------------- live log call ---------------------------------
2021-03-25 20:44:15 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleBlacklist::test_included_keys[RSA] Detected image: image_id=groovy os=ubuntu release=groovy

-------------------------------- live log setup --------------------------------
2021-03-25 20:44:15 INFO      integration_testing:clouds.py:87 Detected image: image_id=groovy os=ubuntu release=groovy
-------------------------------- live log call ---------------------------------
2021-03-25 20:44:15 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[DSA] Detected image: image_id=groovy os=ubuntu release=groovy

-------------------------------- live log setup --------------------------------
2021-03-25 20:44:16 INFO      integration_testing:clouds.py:87 Detected image: image_id=groovy os=ubuntu release=groovy
Launching instance with launch_kwargs:
image_id=local:square-rabbit-snapshot
user_data=#cloud-config
ssh:
  emit_keys_to_console: false

2021-03-25 20:44:16 INFO      integration_testing:clouds.py:167 Launching instance with launch_kwargs:
image_id=local:square-rabbit-snapshot
user_data=#cloud-config
ssh:
  emit_keys_to_console: false

['lxc', 'init', 'local:square-rabbit-snapshot', '--profile', 'pycloudlib-vm-groovy-v2', '--config', 'user.meta-data=public-keys: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJMS8gdKw0kA1PDwAVkURrxgjbAgWVeiBq+VSOI1jFLafONDwkc0ZVriZofmCZ1BVjixCA6kqVQsmA88Av7eeI3jGvy4fwX+TKhDQk28rRC9mNz8nBLfB+gp3wfcgFJrVeekhjV+fgxiyq1wJC4WcJZfXKdXvsNTBzhd2RNZAsyKyRKBRahv57/KJjXozS94p83l0qq/gi6pYYBTTkLz65SiyVCUpkddgXDPfxEXqjsx6ha3VCdoKBdRgh3p2toADzcYafyqxDMPtfLJE+BofSA4Gi9YQAMhshdk4tzI+KYcq07cd8AtreXpVyZLC3r7cfe4m2IK7UvVSbTItYoUItN255P1M09eLQNlbbrJwnxuX3IUwxBkYZhVUIaEOQreWTnc+tg20ZK3olUzNWcJBurpeT5i6Hg/QoRrQSanVLFx8hff4l1V9Yxb23txlv9e2Pzh0i/0YVmrVlQxuen/5YyWNm553D1EfH8fEon3xVAqrbC8NS63GaP0QhGo7rlYs= james@newt\n', '--config', 'user.user-data=#cloud-config\nssh:\n  emit_keys_to_console: false\n', '--vm']
2021-03-25 20:44:16 INFO      pycloudlib.instance:instance.py:165 executing: sh -c whoami
2021-03-25 20:44:36 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.120
Retrying SSH connection to ubuntu@10.37.179.120:22 (579s left)
2021-03-25 20:44:38 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.120
Retrying SSH connection to ubuntu@10.37.179.120:22 (578s left)
2021-03-25 20:44:40 INFO      pycloudlib.instance:instance.py:343 [Errno None] Unable to connect to port 22 on 10.37.179.120
Retrying SSH connection to ubuntu@10.37.179.120:22 (576s left)
2021-03-25 20:44:41 INFO      paramiko.transport:transport.py:1819 Connected (version 2.0, client OpenSSH_8.3p1)
2021-03-25 20:44:41 INFO      paramiko.transport:transport.py:1819 Authentication (publickey) successful!
2021-03-25 20:44:43 INFO      pycloudlib.instance:instance.py:165 executing: sh -c 'cloud-init status --help'
2021-03-25 20:44:43 INFO      pycloudlib.instance:instance.py:165 executing: cloud-init status --wait --long
Launched instance: LXDInstance(name=pet-lamprey)
2021-03-25 20:44:45 INFO      integration_testing:clouds.py:171 Launched instance: LXDInstance(name=pet-lamprey)
2021-03-25 20:44:45 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cloud-init --version'
cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~20.10.1
2021-03-25 20:44:45 INFO      integration_testing:clouds.py:177 cloud-init version: /usr/bin/cloud-init 21.1-19-gbad84ad4-0ubuntu1~20.10.1
2021-03-25 20:44:45 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'grep serial /etc/cloud/build.info'
image serial: 20210323
2021-03-25 20:44:45 INFO      integration_testing:clouds.py:181 image serial: 20210323
-------------------------------- live log call ---------------------------------
2021-03-25 20:44:45 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[ECDSA] Detected image: image_id=groovy os=ubuntu release=groovy

-------------------------------- live log setup --------------------------------
2021-03-25 20:44:45 INFO      integration_testing:clouds.py:87 Detected image: image_id=groovy os=ubuntu release=groovy
-------------------------------- live log call ---------------------------------
2021-03-25 20:44:45 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[ED25519] Detected image: image_id=groovy os=ubuntu release=groovy

-------------------------------- live log setup --------------------------------
2021-03-25 20:44:45 INFO      integration_testing:clouds.py:87 Detected image: image_id=groovy os=ubuntu release=groovy
-------------------------------- live log call ---------------------------------
2021-03-25 20:44:45 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_keys_excluded[RSA] Detected image: image_id=groovy os=ubuntu release=groovy

-------------------------------- live log setup --------------------------------
2021-03-25 20:44:45 INFO      integration_testing:clouds.py:87 Detected image: image_id=groovy os=ubuntu release=groovy
-------------------------------- live log call ---------------------------------
2021-03-25 20:44:45 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_header_excluded Detected image: image_id=groovy os=ubuntu release=groovy

-------------------------------- live log setup --------------------------------
2021-03-25 20:44:45 INFO      integration_testing:clouds.py:87 Detected image: image_id=groovy os=ubuntu release=groovy
-------------------------------- live log call ---------------------------------
2021-03-25 20:44:45 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSED
tests/integration_tests/modules/test_keys_to_console.py::TestKeysToConsoleDisabled::test_footer_excluded Detected image: image_id=groovy os=ubuntu release=groovy

-------------------------------- live log setup --------------------------------
2021-03-25 20:44:45 INFO      integration_testing:clouds.py:87 Detected image: image_id=groovy os=ubuntu release=groovy
-------------------------------- live log call ---------------------------------
2021-03-25 20:44:45 INFO      pycloudlib.instance:instance.py:165 executing: sudo -- sh -c 'cat /var/log/syslog'
PASSEDDeleting snapshot image created for this testrun: local:square-rabbit-snapshot

------------------------------ live log teardown -------------------------------
2021-03-25 20:44:46 INFO      integration_testing:clouds.py:202 Deleting snapshot image created for this testrun: local:square-rabbit-snapshot


======================== 10 passed in 746.01s (0:12:26) ========================


[Regression Potential]
None, as this is a new opt-in feature
